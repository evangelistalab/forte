#! Tests MP2 Natural Orbitals with DSRG-MRMP2.
#! MP2-NOs can be used in place of CASSCF orbitals.
#! We decide to let PSI4 generate the UHF NOS.
#! SAVE_UHF_NOS is used to save the UHF NO into the MO coefficients.  
#! guess_mix true breaks the symmetry of the singlet.  
#! Generated using commit GITCOMMIT

import forte

refmcscf     =  -99.87285247289641 #UHF 
refdsrgpt2   = -100.062842342249922

memory 500 mb

molecule HF{
  0 1
  F
  H  1 R
  R = 1.50
  symmetry c1
}

set globals{
   basis                   cc-pvdz
   reference               UHF
   scf_type                pk
   d_convergence           12
   e_convergence           15
   guess_mix               true
   SAVE_UHF_NOS            true
   UHF_NOONS               5
}

set scf{
   docc                    [5]
   socc                    [0]
   maxiter                 1000
}

set forte{
   job_type                dsrg-mrpt2
   frozen_docc             [1]
   restricted_docc         [3]
   active                  [2]
   root_sym                0
   nroot                   1
   dsrg_s                  1.0
}

energy('scf')
compare_values(refmcscf,get_variable("CURRENT ENERGY"),10,"MCSCF energy")

energy('forte')
compare_values(refdsrgpt2,get_variable("CURRENT ENERGY"),10,"DSRG-MRPT2 energy")
