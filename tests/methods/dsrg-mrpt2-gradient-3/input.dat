
import forte

ref_grad = psi4.Matrix.from_list([
      [0.000000000000,     0.000000000000,     0.052166156449],
      [0.000000000000,     0.000000000000,    -0.052166156449]
      ])

molecule {
0 1
N
N 1 1.1
}

set {
  basis cc-pvdz
  reference rohf
  scf_type pk
  e_convergence 10
  d_convergence 10
  # docc [3,0,1,1]
  restricted_docc [ 2,  0,  0,  0, 0, 2,  0, 0]
  active          [ 1,  0,  1,  1, 0, 1,  1, 1]
   mcscf_type           conv
   mcscf_maxiter        100
   mcscf_diis_start     20
   MCSCF_E_CONVERGENCE  12
   MCSCF_R_CONVERGENCE  10
}

set scf_type direct

set forte {
  REF_TYPE  CASSCF
  CASSCF_G_CONVERGENCE   1e-10
  CASSCF_E_CONVERGENCE   1e-10
  #                Ag B1g B2g B3g Au B1u B2u B3u
  restricted_docc [ 2,  0,  0,  0, 0, 2,  0, 0]
  active          [ 1,  0,  1,  1, 0, 1,  1, 1]
  active_space_solver  cas
  correlation_solver   dsrg-mrpt2
  dsrg_s               1.0
   dsrgpt               true
   print_denom2         true
   multiplicity         1 
}

grad = gradient('forte')
compare_matrices(ref_grad, grad, 6, "DSRG-MRPT2 gradient on N2 with c1 symmetry")
