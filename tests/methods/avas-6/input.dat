#! Test AO Subspace regular expression on 3d orbitals

refscf = -1646.626167484472944
reffci = -1646.647217416001240

import forte
memory 2 gb

molecule FeCp2 {
Fe 0.000000  0.000000  0.000000
C -0.713500 -0.982049 -1.648000
C  0.713500 -0.982049 -1.648000
C  1.154467  0.375109 -1.648000
C  0.000000  1.213879 -1.648000
C -1.154467  0.375109 -1.648000
H -1.347694 -1.854942 -1.638208
H  1.347694 -1.854942 -1.638208
H  2.180615  0.708525 -1.638208
H  0.000000  2.292835 -1.638208
H -2.180615  0.708525 -1.638208
C -0.713500 -0.982049  1.648000
C -1.154467  0.375109  1.648000
C -0.000000  1.213879  1.648000
C  1.154467  0.375109  1.648000
C  0.713500 -0.982049  1.648000
H -1.347694 -1.854942  1.638208
H -2.180615  0.708525  1.638208
H  0.000000  2.292835  1.638208
H  2.180615  0.708525  1.638208
H  1.347694 -1.854942  1.638208
}

basis {
assign 6-31g
assign Fe cc-pvdz
}

set {
scf_type            df
reference           rhf
docc                [18,7,10,13]
}
Escf, wfn = energy('scf', return_wfn=True)
compare_values(refscf, Escf, 8, "SCF energy")

set forte {
avas                true
avas_diagonalize    true
avas_sigma          0.8
subspace            ["Fe(3dxy)","Fe(3dxz)","Fe(3dyz)","Fe(3dz2)","Fe(3dx2-y2)",
                     "C1(2pz)","C2(2pz)","C3(2pz)","C4(2pz)","C5(2pz)",
                     "C6(2pz)","C7(2pz)","C8(2pz)","C9(2pz)","C10(2pz)"]
int_type            df
active_space_solver fci
restricted_docc     [13,5,8,10]
active              [5,3,2,4]
}
Ecasci, wfn = energy('forte', ref_wfn=wfn, return_wfn=True)
compare_values(reffci, Ecasci, 8, "CASCI energy")
