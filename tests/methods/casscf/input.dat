#! Generated using commit GITCOMMIT
#! A test of CASSCF on BeH2 with no symmetry

import forte

refscf       = -15.5049032510
refcasscf     = -15.5107025722

molecule {
  0 1
  Be        0.000000000000     0.000000000000     0.000000000000
  H         0.000000000000     1.390000000000     2.500000000000
  H         0.000000000000    -1.390000000000     2.500000000000
  symmetry c1
  units bohr
  no_reorient
}

set globals{
   scf_type             out_of_core
   d_convergence        10
   e_convergence        10
   basis                3-21g
#   docc                 [2,0,0,0]
#   socc                 [1,0,0,1]
   restricted_docc                  [2]
   active                  [2]
   maxiter              20
   reference            RHF
}
scf = energy('scf')

set forte{
   CASSCF_REFERENCE    true
   CASSCF_ITERATIONS      25
   restricted_docc       [2]
   active                [2]
   int_type             conventional
   cas_type                FCI
   job_type              CASSCF
   CASSCF_CONVERGENCE    1e-6
}
e_casscf = energy('forte')

compare_values(refscf, scf, 6, "SCF ENERGY")
compare_values(e_casscf, refcasscf, 6, "CASSCF ENERGY")

