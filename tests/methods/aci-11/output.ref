    -----------------------------------------------------------------------
          Psi4: An Open-Source Ab Initio Electronic Structure Package
                              Psi4 (no tag) Driver

                          Git: Rev {master} d8d4a3e 

    J. M. Turney, A. C. Simmonett, R. M. Parrish, E. G. Hohenstein,
    F. A. Evangelista, J. T. Fermann, B. J. Mintz, L. A. Burns, J. J. Wilke,
    M. L. Abrams, N. J. Russ, M. L. Leininger, C. L. Janssen, E. T. Seidl,
    W. D. Allen, H. F. Schaefer, R. A. King, E. F. Valeev, C. D. Sherrill,
    and T. D. Crawford, WIREs Comput. Mol. Sci. 2, 556-565 (2012)
    (doi: 10.1002/wcms.93)

                         Additional Contributions by
    A. E. DePrince, M. Saitow, U. Bozkaya, A. Yu. Sokolov
    -----------------------------------------------------------------------


    Psi4 started on: Sat Oct  3 22:13:05 2015

    Process ID:  52420
    PSI4DATADIR: /Users/jeffschriber/Source/psi4/lib
    Memory level set to 256.000 MB

  ==> Input File <==

--------------------------------------------------------------------------
#! Generated using commit GITCOMMIT
# Tests mp2_nos with spin projected system for multiple roots


import forte

refscf = -75.0525898271660026 
refaci = -75.321271108746 
refacipt2 = -75.436493214153

molecule N2{
0 1
C 
C 1 2.6
units angstrom
}

set {
  basis DZ
  scf_type pk
  freeze_core true
  reference rohf 
  e_convergence 10
  d_convergence 10
  r_convergence 10
  docc [2,0,0,0,0,2,1,1]
}



set forte {
  job_type = aci
  multiplicity 1
  perturb_select false
  SELECT_TYPE aimed-energy
  frozen_docc [1,0,0,0,0,1,0,0]
  root_sym 0
  TAUP 0.05
  TAUQ 0.05
  nroot 1
  charge 0
  spin_projection 1
  enforce_spin_complete true
}

energy('scf')

compare_values(refscf, get_variable("CURRENT ENERGY"),9, "SCF energy") #TEST

energy('forte')
compare_values(refaci, get_variable("ACI ENERGY"),9, "ACI energy") #TEST
compare_values(refacipt2, get_variable("ACI+PT2 ENERGY"),8, "ACI+PT2 energy") #TEST
--------------------------------------------------------------------------
/Users/jeffschriber/Source/forte/forte.so loaded.

*** tstart() called on Jeffs-MacBook-Pro.local
*** at Sat Oct  3 22:13:05 2015


         ---------------------------------------------------------
                                   SCF
            by Justin Turney, Rob Parrish, and Andy Simmonett
                             ROHF Reference
                        1 Threads,    256 MiB Core
         ---------------------------------------------------------

  ==> Geometry <==

    Molecular point group: d2h
    Full point group: D_inf_h

    Geometry (in Angstrom), charge = 0, multiplicity = 1:

       Center              X                  Y                   Z               Mass       
    ------------   -----------------  -----------------  -----------------  -----------------
           C          0.000000000000     0.000000000000    -1.300000000000    12.000000000000
           C          0.000000000000     0.000000000000     1.300000000000    12.000000000000

  Running in d2h symmetry.

  Rotational constants: A = ************  B =      0.41562  C =      0.41562 [cm^-1]
  Rotational constants: A = ************  B =  12460.03464  C =  12460.03464 [MHz]
  Nuclear repulsion =    7.327069042015383

  Charge       = 0
  Multiplicity = 1
  Electrons    = 12
  Nalpha       = 6
  Nbeta        = 6

  ==> Algorithm <==

  SCF Algorithm Type is PK.
  DIIS enabled.
  MOM disabled.
  Fractional occupation disabled.
  Guess Type is CORE.
  Energy threshold   = 1.00e-10
  Density threshold  = 1.00e-10
  Integral threshold = 0.00e+00

  ==> Primary Basis <==

  Basis Set: DZ
    Number of shells: 12
    Number of basis function: 20
    Number of Cartesian functions: 20
    Spherical Harmonics?: false
    Max angular momentum: 1

  ==> Pre-Iterations <==

   -------------------------------------------------------
    Irrep   Nso     Nmo     Nalpha   Nbeta   Ndocc  Nsocc
   -------------------------------------------------------
     Ag         6       6       2       2       2       0
     B1g        0       0       0       0       0       0
     B2g        2       2       0       0       0       0
     B3g        2       2       0       0       0       0
     Au         0       0       0       0       0       0
     B1u        6       6       2       2       2       0
     B2u        2       2       1       1       1       0
     B3u        2       2       1       1       1       0
   -------------------------------------------------------
    Total      20      20       6       6       6       0
   -------------------------------------------------------

  Starting with a DF guess...

 OEINTS: Overlap, kinetic, potential, dipole, and quadrupole integrals
         stored in file 35.

  ==> Integral Setup <==

  ==> DFJK: Density-Fitted J/K Matrices <==

    J tasked:                  Yes
    K tasked:                  Yes
    wK tasked:                  No
    OpenMP threads:              1
    Integrals threads:           1
    Memory (MB):               183
    Algorithm:                Core
    Integral Cache:           NONE
    Schwarz Cutoff:          1E-12
    Fitting Condition:       1E-12

   => Auxiliary Basis Set <=

  Basis Set: 
    Number of shells: 50
    Number of basis function: 178
    Number of Cartesian functions: 178
    Spherical Harmonics?: false
    Max angular momentum: 4

  Minimum eigenvalue in the overlap matrix is 8.6152175785E-02.
  Using Symmetric Orthogonalization.
  SCF Guess: Core (One-Electron) Hamiltonian.

  ==> Iterations <==

                           Total Energy        Delta E     RMS |[F,P]|

   @DF-ROHF iter   1:   -72.56548982357322   -7.25655e+01   4.10216e-01 
   @DF-ROHF iter   2:   -74.97478501935241   -2.40930e+00   7.26921e-02 DIIS
   @DF-ROHF iter   3:   -75.04961625102082   -7.48312e-02   9.85308e-03 DIIS
   @DF-ROHF iter   4:   -75.05228668385547   -2.67043e-03   1.65370e-03 DIIS
   @DF-ROHF iter   5:   -75.05248043989803   -1.93756e-04   2.51477e-04 DIIS
   @DF-ROHF iter   6:   -75.05248512057456   -4.68068e-06   1.52962e-05 DIIS
   @DF-ROHF iter   7:   -75.05248515000119   -2.94266e-08   1.35611e-06 DIIS
   @DF-ROHF iter   8:   -75.05248515016206   -1.60867e-10   1.67923e-07 DIIS
   @DF-ROHF iter   9:   -75.05248515016491   -2.85638e-12   6.95439e-09 DIIS
   @DF-ROHF iter  10:   -75.05248515016493   -1.42109e-14   1.05967e-09 DIIS
   @DF-ROHF iter  11:   -75.05248515016491    1.42109e-14   5.39859e-11 DIIS

  DF guess converged.

  ==> Integral Setup <==

 MINTS: Wrapper to libmints.
   by Justin Turney

   Calculation information:
      Number of atoms:                   2
      Number of AO shells:              12
      Number of SO shells:               6
      Number of primitives:             28
      Number of atomic orbitals:        20
      Number of basis functions:        20

      Number of irreps:                  8
      Integral cutoff                 0.00e+00
      Number of functions per irrep: [   6    0    2    2    0    6    2    2 ]

 OEINTS: Overlap, kinetic, potential, dipole, and quadrupole integrals
         stored in file 35.

      Computing two-electron integrals...done
      Computed 3747 non-zero two-electron integrals.
        Stored in file 33.

	Batch   1 pq = [       0,      54] index = [             0,1485]
  ==> DiskJK: Disk-Based J/K Matrices <==

    J tasked:                  Yes
    K tasked:                  Yes
    wK tasked:                  No
    Memory (MB):               183
    Schwarz Cutoff:          1E-12

   @ROHF iter  12:   -75.05258979736340   -1.04647e-04   1.83464e-05 DIIS
   @ROHF iter  13:   -75.05258982588194   -2.85185e-08   8.94345e-06 DIIS
   @ROHF iter  14:   -75.05258982696486   -1.08292e-09   1.87002e-06 DIIS
   @ROHF iter  15:   -75.05258982715931   -1.94447e-10   2.66427e-07 DIIS
   @ROHF iter  16:   -75.05258982716599   -6.67910e-12   1.43733e-08 DIIS
   @ROHF iter  17:   -75.05258982716605   -5.68434e-14   9.68534e-10 DIIS
   @ROHF iter  18:   -75.05258982716600    4.26326e-14   1.10997e-10 DIIS
   @ROHF iter  19:   -75.05258982716603   -2.84217e-14   1.59131e-11 DIIS

  ==> Post-Iterations <==

    Orbital Energies (a.u.)
    -----------------------

    Doubly Occupied:                                                      

       1Ag   -11.470404     1B1u  -11.470326     2Ag    -0.810058  
       2B1u   -0.745371     1B3u   -0.300980     1B2u   -0.300980  

    Singly Occupied:                                                      

    

    Virtual:                                                              

       1B2g   -0.073394     1B3g   -0.073394     3Ag    -0.047958  
       3B1u    0.077537     2B2u    0.444580     2B3u    0.444580  
       4B1u    0.446484     2B2g    0.507663     2B3g    0.507663  
       4Ag     0.549709     5Ag     0.613210     5B1u    0.857554  
       6Ag    23.510751     6B1u   23.582909  

    Final Occupation by Irrep:
             Ag   B1g   B2g   B3g    Au   B1u   B2u   B3u 
    DOCC [     2,    0,    0,    0,    0,    2,    1,    1 ]
    SOCC [     0,    0,    0,    0,    0,    0,    0,    0 ]

  Energy converged.

  @ROHF Final Energy:   -75.05258982716603

   => Energetics <=

    Nuclear Repulsion Energy =              7.3270690420153830
    One-Electron Energy =                -114.5630793886023184
    Two-Electron Energy =                  32.1834205194208991
    DFT Exchange-Correlation Energy =       0.0000000000000000
    Empirical Dispersion Energy =           0.0000000000000000
    PCM Polarization Energy =               0.0000000000000000
    EFP Energy =                            0.0000000000000000
    Total Energy =                        -75.0525898271660310

    Alert: EFP and PCM quantities not currently incorporated into SCF psivars.

Properties will be evaluated at   0.000000,   0.000000,   0.000000 Bohr
  ==> Properties <==


Properties computed using the SCF density matrix

  Nuclear Dipole Moment: (a.u.)
     X:     0.0000      Y:     0.0000      Z:     0.0000

  Electronic Dipole Moment: (a.u.)
     X:     0.0000      Y:     0.0000      Z:     0.0000

  Dipole Moment: (a.u.)
     X:     0.0000      Y:     0.0000      Z:     0.0000     Total:     0.0000

  Dipole Moment: (Debye)
     X:     0.0000      Y:     0.0000      Z:     0.0000     Total:     0.0000


  Saving occupied orbitals to File 180.

*** tstop() called on Jeffs-MacBook-Pro.local at Sat Oct  3 22:13:05 2015
Module time:
	user time   =       0.32 seconds =       0.01 minutes
	system time =       0.03 seconds =       0.00 minutes
	total time  =          0 seconds =       0.00 minutes
Total time:
	user time   =       0.32 seconds =       0.01 minutes
	system time =       0.03 seconds =       0.00 minutes
	total time  =          0 seconds =       0.00 minutes
Reading options from the FORTE block
Calling plugin /Users/jeffschriber/Source/forte/forte.so.


  ==> MO Space Information <==

  Read options for space FROZEN_DOCC
 Removing orbital 0
 Removing orbital 10
  -------------------------------------------------------------------------
                       Ag   B1g   B2g   B3g    Au   B1u   B2u   B3u   Sum
  -------------------------------------------------------------------------
    FROZEN_DOCC         1     0     0     0     0     1     0     0     2
    RESTRICTED_DOCC     0     0     0     0     0     0     0     0     0
    ACTIVE              5     0     2     2     0     5     2     2    18
    RESTRICTED_UOCC     0     0     0     0     0     0     0     0     0
    FROZEN_UOCC         0     0     0     0     0     0     0     0     0
    Total               6     0     2     2     0     6     2     2    20
  -------------------------------------------------------------------------

  ==> Integral Transformation <==

  Number of molecular orbitals:               20
  Number of correlated molecular orbitals:    18
  Number of frozen occupied orbitals:          2
  Number of frozen unoccupied orbitals:        0


 Overall Conventional Integrals timings	Presorting SO-basis two-electron integrals.
	Sorting File: SO Ints (nn|nn) nbuckets = 1
	Transforming the one-electron integrals and constructing Fock matrices
	Starting first half-transformation.
	Sorting half-transformed integrals.
	First half integral transformation complete.
	Starting second half-transformation.
	Two-electron integral transformation complete.

  Integral transformation done. 0.01227400 s
  Reading the two-electron integrals from disk
  Size of two-electron integrals:   0.003576 GB
  Frozen-core energy            -68.788158058678 a.u.
  Freezing MO 0
  Freezing MO 10
  Resorting integrals after freezing core.
 Conventional integrals take 0.01768500 s
  Total electrons: 12
  Number of active electrons: 8
  nalpha: 4
  nbeta:  4 

  There are 2 frozen orbitals.
  There are 18 active orbitals.
  Using ROHF reference.

  Electron removed from 10, out of 8
  Need orbital of symmetry 5
  Added electron to 10
  The reference determinant is:

  |110000000110000000110000000110000000>
  The reference energy is -75.08091943

  ==> Calculation Information <==

  ----------------------------------------------------
    Symmetry                                       0
    Number of roots                                1
    Root used for properties                       0
    P-threshold                             5.00e-02
    Q-threshold                             5.00e-02
    Convergence threshold                   1.00e-10
    Determinant selection criterion         First-order Coefficients
    Selection criterion                     Threshold
    PQ Function                             AVERAGE
    Q Type                                  Absolute Energy
    PT2 Parameters                          False
  ----------------------------------------------------

  Iterative Adaptive CI
  The model space contains 1 determinants

  ==> Cycle 0 <==

  Initial P space dimension: 1

  Determinant space is spin complete.
  Spin-complete dimension of the P space: 1 determinants
  Time spent diagonalizing H using Full: 0.000021 s
  Average spin contamination (0.00000) is less than tolerance (0.01000)
  No need to perform spin projection.

    P-space  CI Energy Root   1        = -75.080919431216 Eh =   0.0000 eV

  Dimension of the SD space: 744 determinants
  Time spent building the model space: 0.000424 s

  Using non-perturbative energy estimates
  Dimension of the P + Q space: 40 determinants
  Time spent screening the model space: 0.001574 s

  Determinant space is spin incomplete!
  4 more determinants are needed.
  Spin-complete dimension of the PQ space: 44

  Davidson-liu sparse algorithm
  Building H using OpenMP-take2
  The sparse Hamiltonian matrix contains 652 nonzero elements out of 1936 (0.336777)
  Time spent building H (openmp): 0.000444 s
  The Davidson-Liu algorithm converged in 100 iterations.
  Time spent diagonalizing H: 0.001122 s
 Average spin contamination (0.00288) is less than tolerance (0.01000)
 No need to perform spin projection.

    PQ-space CI Energy Root   1        = -75.292980482079 Eh =   0.0000 eV
    PQ-space CI Energy + EPT2 Root   1 = -75.366231386845 Eh =   0.0000 eV


  Most important contributions to root   0:
    0  -0.525199 0.275834416           2 |110000000100001000|110000000100001000>
    1   0.505141 0.255167825          19 |110000000100000010|110000000100000010>
    2   0.377416 0.142442541          13 |110000010100000000|110000010100000000>
    3  -0.362285 0.131250187           4 |110001000100000000|110001000100000000>
    4   0.189344 0.035851194          32 |100000000110001000|100000000110001000>
    5  -0.182320 0.033240679          20 |100000000110000010|100000000110000010>
    6   0.139956 0.019587746           9 |110000000110000000|100001000100000010>
    7   0.139956 0.019587717          31 |100001000100000010|110000000110000000>
    8  -0.137650 0.018947405          33 |100000010100001000|110000000110000000>
    9  -0.137646 0.018946331           1 |110000000110000000|100000010100001000>

 Spin state for root 0: S^2 = 0.003, S = 0.003, singlet (from 44 determinants, 100.00)

  ==> Cycle 1 <==

  Initial P space dimension: 18

  Determinant space is spin complete.
  Spin-complete dimension of the P space: 18 determinants

  Davidson-liu sparse algorithm
  Building H using OpenMP-take2
  The sparse Hamiltonian matrix contains 176 nonzero elements out of 324 (0.543210)
  Time spent building H (openmp): 0.000133 s
  The Davidson-Liu algorithm converged in 100 iterations.
  Time spent diagonalizing H: 0.000758 s
  Average spin contamination (0.00051) is less than tolerance (0.01000)
  No need to perform spin projection.

    P-space  CI Energy Root   1        = -75.291209468059 Eh =   0.0000 eV

  Dimension of the SD space: 8971 determinants
  Time spent building the model space: 0.007126 s

  Using non-perturbative energy estimates
  Dimension of the P + Q space: 24 determinants
  Time spent screening the model space: 0.018106 s

  Determinant space is spin complete.
  Spin-complete dimension of the PQ space: 24

  Davidson-liu sparse algorithm
  Building H using OpenMP-take2
  The sparse Hamiltonian matrix contains 268 nonzero elements out of 576 (0.465278)
  Time spent building H (openmp): 0.000201 s
  The Davidson-Liu algorithm converged in 88 iterations.
  Time spent diagonalizing H: 0.000652 s
 Average spin contamination (0.00000) is less than tolerance (0.01000)
 No need to perform spin projection.

    PQ-space CI Energy Root   1        = -75.328311961613 Eh =   0.0000 eV
    PQ-space CI Energy + EPT2 Root   1 = -75.444963460400 Eh =   0.0000 eV


  Most important contributions to root   0:
    0  -0.503883 0.253897646           1 |110000000100001000|110000000100001000>
    1   0.503882 0.253897556          12 |110000000100000010|110000000100000010>
    2  -0.350603 0.122922685           2 |110001000100000000|110001000100000000>
    3   0.350603 0.122922505           8 |110000010100000000|110000010100000000>
    4  -0.213582 0.045617326          13 |100000000110000010|100000000110000010>
    5   0.213582 0.045617307          16 |100000000110001000|100000000110001000>
    6   0.174259 0.030366353          21 |100001000110000000|100001000110000000>
    7  -0.174259 0.030366338          23 |100000010110000000|100000010110000000>
    8   0.118239 0.013980444           7 |110000000110000000|100001000100000010>
    9   0.118239 0.013980444          15 |100001000100000010|110000000110000000>

 Spin state for root 0: S^2 = 0.000, S = 0.000, singlet (from 24 determinants, 100.00)

  ==> Cycle 2 <==

  Initial P space dimension: 16

  Determinant space is spin incomplete!
  4 more determinants are needed.
  Spin-complete dimension of the P space: 20 determinants

  Davidson-liu sparse algorithm
  Building H using OpenMP-take2
  The sparse Hamiltonian matrix contains 216 nonzero elements out of 400 (0.540000)
  Time spent building H (openmp): 0.000172 s
  The Davidson-Liu algorithm converged in 94 iterations.
  Time spent diagonalizing H: 0.000730 s
  Average spin contamination (0.00000) is less than tolerance (0.01000)
  No need to perform spin projection.

    P-space  CI Energy Root   1        = -75.321271108746 Eh =   0.0000 eV

  Dimension of the SD space: 9789 determinants
  Time spent building the model space: 0.005864 s

  Using non-perturbative energy estimates
  Dimension of the P + Q space: 20 determinants
  Time spent screening the model space: 0.021244 s

  Determinant space is spin complete.
  Spin-complete dimension of the PQ space: 20

  Davidson-liu sparse algorithm
  Building H using OpenMP-take2
  The sparse Hamiltonian matrix contains 216 nonzero elements out of 400 (0.540000)
  Time spent building H (openmp): 0.000145 s
  The Davidson-Liu algorithm converged in 94 iterations.
  Time spent diagonalizing H: 0.000636 s
 Average spin contamination (0.00000) is less than tolerance (0.01000)
 No need to perform spin projection.

    PQ-space CI Energy Root   1        = -75.321271108746 Eh =   0.0000 eV
    PQ-space CI Energy + EPT2 Root   1 = -75.436493214153 Eh =   0.0000 eV


  Most important contributions to root   0:
    0   0.508399 0.258469203           1 |110000000100001000|110000000100001000>
    1  -0.508399 0.258469057           8 |110000000100000010|110000000100000010>
    2   0.349731 0.122312020           2 |110001000100000000|110001000100000000>
    3  -0.349731 0.122311812           6 |110000010100000000|110000010100000000>
    4   0.197461 0.038990922           9 |100000000110000010|100000000110000010>
    5  -0.197461 0.038990899          12 |100000000110001000|100000000110001000>
    6  -0.180292 0.032505233          14 |100001000110000000|100001000110000000>
    7   0.180292 0.032505219          15 |100000010110000000|100000010110000000>
    8  -0.122222 0.014938275           5 |110000000110000000|100001000100000010>
    9  -0.122222 0.014938275          11 |100001000100000010|110000000110000000>

 Spin state for root 0: S^2 = 0.000, S = 0.000, singlet (from 20 determinants, 100.00)

  ==> Cycle 3 <==

  Initial P space dimension: 16

  Determinant space is spin incomplete!
  4 more determinants are needed.
  Spin-complete dimension of the P space: 20 determinants

  Davidson-liu sparse algorithm
  Building H using OpenMP-take2
  The sparse Hamiltonian matrix contains 216 nonzero elements out of 400 (0.540000)
  Time spent building H (openmp): 0.000133 s
  The Davidson-Liu algorithm converged in 94 iterations.
  Time spent diagonalizing H: 0.000608 s
  Average spin contamination (0.00000) is less than tolerance (0.01000)
  No need to perform spin projection.

    P-space  CI Energy Root   1        = -75.321271108746 Eh =   0.0000 eV

  Dimension of the SD space: 9789 determinants
  Time spent building the model space: 0.005995 s

  Using non-perturbative energy estimates
  Dimension of the P + Q space: 20 determinants
  Time spent screening the model space: 0.021698 s

  Determinant space is spin complete.
  Spin-complete dimension of the PQ space: 20

  Davidson-liu sparse algorithm
  Building H using OpenMP-take2
  The sparse Hamiltonian matrix contains 216 nonzero elements out of 400 (0.540000)
  Time spent building H (openmp): 0.000139 s
  The Davidson-Liu algorithm converged in 94 iterations.
  Time spent diagonalizing H: 0.000763 s
 Average spin contamination (0.00000) is less than tolerance (0.01000)
 No need to perform spin projection.

    PQ-space CI Energy Root   1        = -75.321271108746 Eh =   0.0000 eV
    PQ-space CI Energy + EPT2 Root   1 = -75.436493214153 Eh =   0.0000 eV


  ==> Post-Iterations <==

  Not performing spin projection.
  Printing Wavefunction Information

  Most important contributions to root   0:
    0   0.508399 0.258469203           1 |110000000100001000|110000000100001000>
    1  -0.508399 0.258469057           8 |110000000100000010|110000000100000010>
    2   0.349731 0.122312020           2 |110001000100000000|110001000100000000>
    3  -0.349731 0.122311812           6 |110000010100000000|110000010100000000>
    4   0.197461 0.038990922           9 |100000000110000010|100000000110000010>
    5  -0.197461 0.038990899          12 |100000000110001000|100000000110001000>
    6  -0.180292 0.032505233          14 |100001000110000000|100001000110000000>
    7   0.180292 0.032505219          15 |100000010110000000|100000010110000000>
    8  -0.122222 0.014938275           5 |110000000110000000|100001000100000010>
    9  -0.122222 0.014938275          11 |100001000100000010|110000000110000000>

 Spin state for root 0: S^2 = 0.000, S = 0.000, singlet (from 20 determinants, 100.00)

     Order		 # of Dets        Total |c^2|   
  __________ 	____________   ________________ 
      0			       2		0.25963559305
      1			      11		0.61133527582
      2			       7		0.12902913113

 Highest-order excitation searched:     8  

  * Adaptive-CI Energy Root   1        = -75.321271108746 Eh =   0.0000 eV
  * Adaptive-CI Energy Root   1 + EPT2 = -75.436493214153 Eh =   0.0000 eV

  Adaptive-CI (bitset) ran in : 0.099097 s

  Saving information for root: 1
 Your calculation took 0.23247800 seconds
*** PSI4 exiting successfully. Buy a developer a beer!
