    -----------------------------------------------------------------------
          Psi4: An Open-Source Ab Initio Electronic Structure Package
                              Psi4 (no tag) Driver

                          Git: Rev {detached?} 7a17eb9 dirty

    J. M. Turney, A. C. Simmonett, R. M. Parrish, E. G. Hohenstein,
    F. A. Evangelista, J. T. Fermann, B. J. Mintz, L. A. Burns, J. J. Wilke,
    M. L. Abrams, N. J. Russ, M. L. Leininger, C. L. Janssen, E. T. Seidl,
    W. D. Allen, H. F. Schaefer, R. A. King, E. F. Valeev, C. D. Sherrill,
    and T. D. Crawford, WIREs Comput. Mol. Sci. 2, 556-565 (2012)
    (doi: 10.1002/wcms.93)

                         Additional Contributions by
    A. E. DePrince, M. Saitow, U. Bozkaya, A. Yu. Sokolov
    -----------------------------------------------------------------------


    Psi4 started on: Fri Jan 22 16:49:16 2016

    Process ID:  20724
    PSI4DATADIR: /Users/jeffschriber/src/psi4/lib
    Memory level set to 256.000 MB

  ==> Input File <==

--------------------------------------------------------------------------
#! This tests the Adaptive-CI procedure using energy selection
#! Generated using commit GITCOMMIT
#

import forte

refscf = -14.839846512738 #TEST
refaci = -14.889029534777 #TEST
refacipt2 = -14.890144527518 #TEST

molecule li2{
   Li
   Li 1 2.0000
}

set {
  basis DZ
  e_convergence 10
  d_convergence 10
  r_convergence 10
}

set mcscf {
  reference rhf
  docc = [2,0,0,0,0,1,0,0]
}

set forte {
  job_type = aci
  frozen_docc = [0,0,0,0,0,0,0,0]
  SELECT_TYPE amp
  TAUP 0.01000
  TAUQ 0.001000
  enforce_spin_complete false
  nroot 1
  charge 0
}

energy('mcscf')

compare_values(refscf, get_variable("CURRENT ENERGY"),9, "SCF energy") #TEST

energy('forte')
compare_values(refaci, get_variable("ACI ENERGY"),9, "ACI energy") #TEST
compare_values(refacipt2, get_variable("ACI+PT2 ENERGY"),8, "ACI+PT2 energy") #TEST
--------------------------------------------------------------------------
/Users/jeffschriber/src/forte/forte.so loaded.

         ------------------------------------------
           MCSCF: a self-consistent field program
            written by Francesco A. Evangelista
         ------------------------------------------ MINTS: Wrapper to libmints.
   by Justin Turney

   Calculation information:
      Number of atoms:                   2
      Number of AO shells:              12
      Number of SO shells:               6
      Number of primitives:             26
      Number of atomic orbitals:        20
      Number of basis functions:        20

      Number of irreps:                  8
      Integral cutoff                 1.00e-12
      Number of functions per irrep: [   6    0    2    2    0    6    2    2 ]

 OEINTS: Overlap, kinetic, potential, dipole, and quadrupole integrals
         stored in file 35.

      Computing two-electron integrals...done
      Computed 3747 non-zero two-electron integrals.
        Stored in file 33.



  MOs per irrep:                  Ag  B1g  B2g  B3g  Au  B1u  B2u  B3u Total
  ----------------------------------------------------------------------------
  Total                            6    0    2    2    0    6    2    2    20
  Doubly Occupied                  2    0    0    0    0    1    0    0     3
  Active/Singly Occupied           0    0    0    0    0    0    0    0     0
  ----------------------------------------------------------------------------

  Running an SCF calculation

  Generated 210 pairs
  Distributed as [54 Ag][8 B1g][24 B2g][24 B3g][8 Au][44 B1u][24 B2u][24 B3u]
  batch   0 pq = [       0,      54] index = [               0,            1485]

  Allocated the PK matrix (1485 elements) 
  Reading the two-electron integrals to form PK ... 
  batch   0 ... done.


  =========================================================================================
         Cycle          Energy               D(Energy)            D(Density)            DIIS
  ===========================================================================================
  Setting level shift to 0.000 S
  @SCF    0      -14.136059311230     -14.136059311230       0.095337958030
  Setting level shift to 0.000 S
  @SCF    1      -14.828675458728      -0.692616147499       0.058753904394
  Setting level shift to 0.000 S
  @SCF    2      -14.838795458849      -0.010120000120       0.006460980121
  Setting level shift to 0.000 S
  @SCF    3      -14.839682630439      -0.000887171590       0.002036669603
  Setting level shift to 0.000 S
  @SCF    4      -14.839815951879      -0.000133321440       0.000719150681
  Setting level shift to 0.000 S
  @SCF    5      -14.839840228698      -0.000024276819       0.000294864044
  Setting level shift to 0.000 S
  @SCF    6      -14.839845149434      -0.000004920736       0.000137859860
  Setting level shift to 0.000 S/E
  @SCF    7      -14.839846208598      -0.000001059164       0.000067970841
  Setting level shift to 0.000 S/E
  @SCF    8      -14.839846512738      -0.000000304140       0.000066215673
  Setting level shift to 0.000 S/E
  @SCF    9      -14.839846512738      -0.000000000000       0.000000051860
  Setting level shift to 0.000 S/E
  @SCF   10      -14.839846512738      -0.000000000000       0.000000002206
  Setting level shift to 0.000 S/E
  @SCF   11      -14.839846512738       0.000000000000       0.000000000181
  Setting level shift to 0.000 S/E
  @SCF   12      -14.839846512738       0.000000000000       0.000000000007
  Setting level shift to 0.000 S/E
  @SCF   13      -14.839846512738      -0.000000000000       0.000000000001
  Setting level shift to 0.000 S/E
  @SCF   14      -14.839846512738       0.000000000000       0.000000000000
  Setting level shift to 0.000 S/E
  @SCF   15      -14.839846512738       0.000000000000       0.000000000000
  Setting level shift to 0.000 S/E
  @SCF   16      -14.839846512738      -0.000000000000       0.000000000000
  =========================================================================================

      * SCF total energy   =     -14.839846512738


  End of SCF
  MOs orthonormality check passed.

  Orbitals are canonicalized as:
  inactive (docc + uocc) : Fock(core)
  active   (actv)        : Fock(core)

  =========================================================================
  Eigenvalues (Eh)
  -------------------------------------------------------------------------
  Doubly occupied orbitals
      1     -2.470948  Ag      2     -2.465815 B1u      3     -0.194380  Ag
  Unoccupied orbitals
      4      0.012721 B1u      5      0.026034 B2u      6      0.026034 B3u
      7      0.049075  Ag      8      0.069563 B2g      9      0.069563 B3g
     10      0.080420 B1u     11      0.130086  Ag     12      0.137741 B2u
     13      0.137741 B3u     14      0.171764  Ag     15      0.242777 B2g
     16      0.242777 B3g     17      0.246004 B1u     18      0.480486 B1u
     19      1.695539  Ag     20      1.801802 B1u
  =========================================================================


  MCSCF Execution Completed.


*** tstop() called on Jeffs-MBP.attlocal.net at Fri Jan 22 16:49:16 2016
Module time:
	user time   =       0.24 seconds =       0.00 minutes
	system time =       0.08 seconds =       0.00 minutes
	total time  = 1453499356 seconds = 24224989.27 minutes
Total time:
	user time   =       0.24 seconds =       0.00 minutes
	system time =       0.08 seconds =       0.00 minutes
	total time  = 1453499356 seconds = 24224989.27 minutes
Reading options from the FORTE block
Calling plugin /Users/jeffschriber/src/forte/forte.so.


  ==> MO Space Information <==

  Read options for space FROZEN_DOCC
  -------------------------------------------------------------------------
                       Ag   B1g   B2g   B3g    Au   B1u   B2u   B3u   Sum
  -------------------------------------------------------------------------
    FROZEN_DOCC         0     0     0     0     0     0     0     0     0
    RESTRICTED_DOCC     0     0     0     0     0     0     0     0     0
    ACTIVE              6     0     2     2     0     6     2     2    20
    RESTRICTED_UOCC     0     0     0     0     0     0     0     0     0
    FROZEN_UOCC         0     0     0     0     0     0     0     0     0
    Total               6     0     2     2     0     6     2     2    20
  -------------------------------------------------------------------------

  ==> Integral Transformation <==

  Number of molecular orbitals:               20
  Number of correlated molecular orbitals:    20
  Number of frozen occupied orbitals:          0
  Number of frozen unoccupied orbitals:        0


  Overall Conventional Integrals timings

	Presorting SO-basis two-electron integrals.
	Sorting File: SO Ints (nn|nn) nbuckets = 1
	Transforming the one-electron integrals and constructing Fock matrices
	Starting first half-transformation.
	Sorting half-transformed integrals.
	First half integral transformation complete.
	Starting second half-transformation.
	Two-electron integral transformation complete.

  Integral transformation done. 0.01272300 s
  Reading the two-electron integrals from disk
  Size of two-electron integrals:   0.003576 GB
  Conventional integrals take 0.02193500 s

                    ---------------------------------------
                      Adaptive Configuration Interaction
                      written by Francesco A. Evangelista
                    ---------------------------------------

  ==> Reference Information <==

  There are 0 frozen orbitals.
  There are 20 active orbitals.

  |22000000002000000000>
  REFERENCE ENERGY:         -14.839846512738
  ==> Calculation Information <==

  -----------------------------------------------------------------
    Multiplicity                             1    
    Symmetry                                 0    
    Number of roots                          1    
    Root used for properties                 0    
    P-threshold                              1.00e-02
    Q-threshold                              1.00e-03
    Convergence threshold                    1.00e-10
    Determinant selection criterion          First-order Coefficients
    Selection criterion                      Threshold
    PQ Function                              AVERAGE
    Q Type                                   Absolute Energy
    PT2 Parameters                           False
    Project out spin contaminants            True
    Enforce spin completeness of basis       False
    Enforce complete aimed selection         True
  -----------------------------------------------------------------

  ==> Cycle 0 <==

  Initial P space dimension: 1
 Not checking for spin-completeness.
  Time spent diagonalizing H:   0.000055 s
  Not performing spin projection.

    P-space  CI Energy Root   1        = -14.839846512738 Eh =   0.0000 eV

  Dimension of the SD space: 661 determinants
  Time spent building the model space: 0.001885 s

  Using non-perturbative energy estimates
  Dimension of the P + Q space: 223 determinants
  Time spent screening the model space: 0.004939 s

  Davidson-liu solver algorithm
  Generating determinants with N-1 electrons.

  Memory for single-hole lists: 0.012760 MB
  Memory for single-hole maps:  0.040054 MB
  Generating determinants with N-2 electrons.

  Memory for double-hole lists: 0.038280 MB
  Memory for double-hole maps:  0.059242 MB
  number of guess vectors: 2
  Initial guess found 14 solutions with 2S+1 = 1 *
  Initial guess found 6 solutions with 2S+1 = 3  
  Adding guess 0 (multiplicity = 1.000000)
  Adding guess 1 (multiplicity = 1.000000)

  ==> Diagonalizing Hamiltonian <==

  ----------------------------------------
    Iter.      Avg. Energy       Delta_E
  ----------------------------------------
      1      -17.252171134824  -1.725e+01
      2      -17.268741353014  -1.657e-02
      3      -17.269059183283  -3.178e-04
      4      -17.269086158106  -2.697e-05
      5      -17.269090531850  -4.374e-06
      6      -17.269091046582  -5.147e-07
      7      -17.269091130888  -8.431e-08
      8      -17.269091145200  -1.431e-08
      9      -17.269091148211  -3.011e-09
     10      -17.269091148672  -4.611e-10
     11      -17.269091148750  -7.736e-11
  ----------------------------------------
  The Davidson-Liu algorithm converged in 12 iterations.
  Time spent diagonalizing H:   0.068219 s
  Not performing spin projection.

    PQ-space CI Energy Root   1        = -14.887793710095 Eh =   0.0000 eV
    PQ-space CI Energy + EPT2 Root   1 = -14.888142689394 Eh =   0.0000 eV


  Most important contributions to root   0:
    0  -0.945201 0.893405473           0 |22000000002000000000>
    1   0.141631 0.020059242          51 |20000000002000000020>
    2   0.141631 0.020059242          53 |20000000002000002000>
    3   0.096282 0.009270136         222 |200000000020000000-+>
    4   0.096282 0.009270136          50 |200000000020000000+->
    5   0.096282 0.009270136         145 |2000000000200000-+00>
    6   0.096282 0.009270136         179 |2000000000200000+-00>
    7   0.067947 0.004616755         193 |20000000002000000002>
    8   0.067947 0.004616755         191 |20000000002000000200>
    9   0.056087 0.003145765          73 |20020000002000000000>

  Spin state for root 0: S^2 = 0.000, S = 0.000, singlet (from 223 determinants, 100.00)

  ==> Cycle 1 <==

  Initial P space dimension: 38
 Not checking for spin-completeness.
  Time spent diagonalizing H:   0.002562 s
  Not performing spin projection.

    P-space  CI Energy Root   1        = -14.883654851818 Eh =   0.0000 eV

  Dimension of the SD space: 11503 determinants
  Time spent building the model space: 0.098850 s

  Using non-perturbative energy estimates
  Dimension of the P + Q space: 256 determinants
  Time spent screening the model space: 0.085398 s

  Davidson-liu solver algorithm
  Generating determinants with N-1 electrons.

  Memory for single-hole lists: 0.014648 MB
  Memory for single-hole maps:  0.045700 MB
  Generating determinants with N-2 electrons.

  Memory for double-hole lists: 0.043945 MB
  Memory for double-hole maps:  0.066872 MB
  number of guess vectors: 2
  Initial guess found 13 solutions with 2S+1 = 1 *
  Initial guess found 7 solutions with 2S+1 = 3  
  Adding guess 0 (multiplicity = 1.000000)
  Adding guess 1 (multiplicity = 1.000000)

  ==> Diagonalizing Hamiltonian <==

  ----------------------------------------
    Iter.      Avg. Energy       Delta_E
  ----------------------------------------
      1      -17.248310045235  -1.725e+01
      2      -17.269727168903  -2.142e-02
      3      -17.270271246178  -5.441e-04
      4      -17.270301068507  -2.982e-05
      5      -17.270304834564  -3.766e-06
      6      -17.270305291253  -4.567e-07
      7      -17.270305369594  -7.834e-08
      8      -17.270305379993  -1.040e-08
      9      -17.270305381762  -1.769e-09
     10      -17.270305382067  -3.057e-10
     11      -17.270305382128  -6.006e-11
  ----------------------------------------
  The Davidson-Liu algorithm converged in 12 iterations.
  Time spent diagonalizing H:   0.086299 s
  Not performing spin projection.

    PQ-space CI Energy Root   1        = -14.889007943473 Eh =   0.0000 eV
    PQ-space CI Energy + EPT2 Root   1 = -14.890147346865 Eh =   0.0000 eV


  Most important contributions to root   0:
    0  -0.939999 0.883598074           0 |22000000002000000000>
    1   0.150106 0.022531861           5 |20000000002000002000>
    2   0.150077 0.022522981           4 |20000000002000000020>
    3   0.102054 0.010414926          30 |2000000000200000+-00>
    4   0.102054 0.010414926          27 |2000000000200000-+00>
    5   0.102033 0.010410741          37 |200000000020000000-+>
    6   0.102033 0.010410741           3 |200000000020000000+->
    7   0.069613 0.004845907          33 |20000000002000000200>
    8   0.069600 0.004844093          34 |20000000002000000002>
    9   0.054588 0.002979890          12 |20020000002000000000>

  Spin state for root 0: S^2 = 0.000, S = 0.000, singlet (from 256 determinants, 100.00)

  ==> Cycle 2 <==

  Initial P space dimension: 41
 Not checking for spin-completeness.
  Time spent diagonalizing H:   0.002682 s
  Not performing spin projection.

    P-space  CI Energy Root   1        = -14.883751524570 Eh =   0.0000 eV

  Dimension of the SD space: 11861 determinants
  Time spent building the model space: 0.109053 s

  Using non-perturbative energy estimates
  Dimension of the P + Q space: 260 determinants
  Time spent screening the model space: 0.090622 s

  Davidson-liu solver algorithm
  Generating determinants with N-1 electrons.

  Memory for single-hole lists: 0.014877 MB
  Memory for single-hole maps:  0.046234 MB
  Generating determinants with N-2 electrons.

  Memory for double-hole lists: 0.044632 MB
  Memory for double-hole maps:  0.067329 MB
  number of guess vectors: 2
  Initial guess found 13 solutions with 2S+1 = 1 *
  Initial guess found 7 solutions with 2S+1 = 3  
  Adding guess 0 (multiplicity = 1.000000)
  Adding guess 1 (multiplicity = 1.000000)

  ==> Diagonalizing Hamiltonian <==

  ----------------------------------------
    Iter.      Avg. Energy       Delta_E
  ----------------------------------------
      1      -17.248310045235  -1.725e+01
      2      -17.269743581672  -2.143e-02
      3      -17.270292753652  -5.492e-04
      4      -17.270322634283  -2.988e-05
      5      -17.270326420888  -3.787e-06
      6      -17.270326880920  -4.600e-07
      7      -17.270326960565  -7.964e-08
      8      -17.270326971224  -1.066e-08
      9      -17.270326973041  -1.817e-09
     10      -17.270326973357  -3.158e-10
     11      -17.270326973419  -6.222e-11
  ----------------------------------------
  The Davidson-Liu algorithm converged in 12 iterations.
  Time spent diagonalizing H:   0.084551 s
  Not performing spin projection.

    PQ-space CI Energy Root   1        = -14.889029534764 Eh =   0.0000 eV
    PQ-space CI Energy + EPT2 Root   1 = -14.890144527185 Eh =   0.0000 eV


  Most important contributions to root   0:
    0  -0.939965 0.883534205           0 |22000000002000000000>
    1   0.150071 0.022521197           5 |20000000002000002000>
    2   0.150041 0.022512317           4 |20000000002000000020>
    3   0.102082 0.010420812          30 |2000000000200000+-00>
    4   0.102082 0.010420812          27 |2000000000200000-+00>
    5   0.102061 0.010416495          37 |200000000020000000-+>
    6   0.102061 0.010416495           3 |200000000020000000+->
    7   0.069872 0.004882100          33 |20000000002000000200>
    8   0.069859 0.004880211          34 |20000000002000000002>
    9   0.054567 0.002977612          12 |20020000002000000000>

  Spin state for root 0: S^2 = 0.000, S = 0.000, singlet (from 260 determinants, 100.00)

  ==> Cycle 3 <==

  Initial P space dimension: 41
 Not checking for spin-completeness.
  Time spent diagonalizing H:   0.002935 s
  Not performing spin projection.

    P-space  CI Energy Root   1        = -14.883751524570 Eh =   0.0000 eV

  Dimension of the SD space: 11861 determinants
  Time spent building the model space: 0.111284 s

  Using non-perturbative energy estimates
  Dimension of the P + Q space: 260 determinants
  Time spent screening the model space: 0.093535 s

  Davidson-liu solver algorithm
  Generating determinants with N-1 electrons.

  Memory for single-hole lists: 0.014877 MB
  Memory for single-hole maps:  0.046234 MB
  Generating determinants with N-2 electrons.

  Memory for double-hole lists: 0.044632 MB
  Memory for double-hole maps:  0.067329 MB
  number of guess vectors: 2
  Initial guess found 13 solutions with 2S+1 = 1 *
  Initial guess found 7 solutions with 2S+1 = 3  
  Adding guess 0 (multiplicity = 1.000000)
  Adding guess 1 (multiplicity = 1.000000)

  ==> Diagonalizing Hamiltonian <==

  ----------------------------------------
    Iter.      Avg. Energy       Delta_E
  ----------------------------------------
      1      -17.248310045235  -1.725e+01
      2      -17.269743581672  -2.143e-02
      3      -17.270292753652  -5.492e-04
      4      -17.270322634283  -2.988e-05
      5      -17.270326420888  -3.787e-06
      6      -17.270326880920  -4.600e-07
      7      -17.270326960565  -7.964e-08
      8      -17.270326971224  -1.066e-08
      9      -17.270326973041  -1.817e-09
     10      -17.270326973357  -3.158e-10
     11      -17.270326973419  -6.222e-11
  ----------------------------------------
  The Davidson-Liu algorithm converged in 12 iterations.
  Time spent diagonalizing H:   0.088058 s
  Not performing spin projection.

    PQ-space CI Energy Root   1        = -14.889029534764 Eh =   0.0000 eV
    PQ-space CI Energy + EPT2 Root   1 = -14.890144527185 Eh =   0.0000 eV

  ***** Calculation Converged *****
  Not performing spin projection.
  1-RDM  took 0.002244 s

  ==> ACI Summary <==

  Iterations required:                         3
  Dimension of optimized determinant space:    260

  * Adaptive-CI Energy Root   1        = -14.889029534764 Eh =   0.0000 eV
  * Adaptive-CI Energy Root   1 + EPT2 = -14.890144527185 Eh =   0.0000 eV

  ==> Wavefunction Information <==

  Most important contributions to root   0:
    0  -0.939965 0.883534205           0 |22000000002000000000>
    1   0.150071 0.022521197           5 |20000000002000002000>
    2   0.150041 0.022512317           4 |20000000002000000020>
    3   0.102082 0.010420812          30 |2000000000200000+-00>
    4   0.102082 0.010420812          27 |2000000000200000-+00>
    5   0.102061 0.010416495          37 |200000000020000000-+>
    6   0.102061 0.010416495           3 |200000000020000000+->
    7   0.069872 0.004882100          33 |20000000002000000200>
    8   0.069859 0.004880211          34 |20000000002000000002>
    9   0.054567 0.002977612          12 |20020000002000000000>

  Spin state for root 0: S^2 = 0.000, S = 0.000, singlet (from 260 determinants, 100.00)

     Order		 # of Dets        Total |c^2|   
  __________ 	____________   ________________ 
       0                  1           0.88353420506
       1                 12           0.00050925470
       2                195           0.11580020069
       3                  0           0.00000000000
       4                 52           0.00015633954

  Highest-order excitation searched:     8  


  Adaptive-CI (bitset) ran in : 1.297817 s

  Saving information for root: 1

  Your calculation took 1.40334300 seconds

*** PSI4 exiting successfully. Buy a developer a beer!
