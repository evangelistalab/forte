# Test read_orbitals keyword without a ref_wfn and
# the orbitals on disk were generated at a different geometry.

import forte

psi4_casscf = -99.922927691438559

memory 500 mb

molecule HF{
  0 1
  F
  H  1 1.6
}

set globals{
  basis                   cc-pvdz
  reference               rhf
  scf_type                df
  d_convergence           8
  e_convergence           9
  df_basis_scf            cc-pvdz-jkfit
}

set forte{
  int_type                df
  active_space_solver     fci
  frozen_docc             [1,0,0,0]
  restricted_docc         [1,0,1,1]
  active                  [2,0,0,0]
  read_orbitals           true  # generated @ 1.5
  mcscf_reference         false
}
Ecas, wfn = energy('forte', return_wfn=True)
compare_values(psi4_casscf, Ecas, 8, "CASCI(READ)/cc-pVDZ energy")

S = psi4.core.triplet(wfn.Ca(), wfn.S(), wfn.Ca(), True, False, False)
Sref = S.clone()
Sref.identity()
compare_matrices(Sref, S, 10, "Orthonormality of MO overlap matrix")
