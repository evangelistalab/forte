#! Test AVAS algorithm with a target number of occupied/virtual active orbitals 

import forte

refscf = -113.87663391962522
reffci = -113.911667467206257

molecule {
0 1
C           -0.000000000000    -0.000000000006    -0.599542970149
O           -0.000000000000     0.000000000001     0.599382404096
H           -0.000000000000    -0.938817812172    -1.186989139808
H            0.000000000000     0.938817812225    -1.186989139839
noreorient
}

set {
  basis cc-pVDZ
  reference rhf
  scf_type pk
  e_convergence 12
}

set forte {
  subspace ["C(2px)","O(2px)"]
  avas True
  avas_diagonalize true
  avas_num_active_occ 1
  avas_num_active_vir 2
  active_space_solver fci
  print 1
  restricted_docc [5,0,0,2]
  active [0,0,3,0]
  root_sym 0
  multiplicity 1
  ms 0.0
}

Escf, wfn = energy('scf', return_wfn=True)
compare_values(refscf, variable("CURRENT ENERGY"), 9, "SCF energy")

energy('forte', ref_wfn=wfn)
compare_values(reffci, variable("CURRENT ENERGY"), 9, "FCI energy")
