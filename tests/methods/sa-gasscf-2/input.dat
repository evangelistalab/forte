#! Generated using commit GITCOMMIT 
# SA-GASSCF for core-excited state with core orbital frozen
# Without CASSCF_FROZEN_ORBITAL the state will collapse to ground state and not converge

import forte

refscf = -76.0172965561 #TEST
refgasscf = -66.12966484124343935 #TEST

memory 1000mb
molecule h2o{
   O
   H  1 1.00
   H  1 1.00 2 103.1
}

set global {
  basis 6-31g**
  e_convergence 10
  d_convergence 10
  r_convergence 10
  guess gwh
  scf_type direct
  reference rhf
}

set forte {
  e_convergence 10
  sigma 0.00
  one_cycle true
  active_ref_type gas
  GAS1 [1,0,0,0]
  GAS2 [3,0,1,2]
  GAS1MAX [2,1]
  GAS1MIN [0,1]
  AVG_STATE [[0,1,1],[0,1,1]]
  job_type casscf
  casscf_ci_solver aci
  casscf_maxiter 100
  casscf_e_convergence 1e-10
  casscf_active_frozen_orbital [0]
  casscf_diis_start 15
}

escf, wfn = energy('scf', return_wfn=True)
egasscf = energy('forte', ref_wfn=wfn)
compare_values(refgasscf, egasscf, 9, "GASSCF energy") #TEST
