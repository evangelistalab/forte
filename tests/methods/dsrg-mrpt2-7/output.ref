    -----------------------------------------------------------------------
          Psi4: An Open-Source Ab Initio Electronic Structure Package
                              Psi4 1.0rc128 Driver

                          Git: Rev {master} 00a658f 

    J. M. Turney, A. C. Simmonett, R. M. Parrish, E. G. Hohenstein,
    F. A. Evangelista, J. T. Fermann, B. J. Mintz, L. A. Burns, J. J. Wilke,
    M. L. Abrams, N. J. Russ, M. L. Leininger, C. L. Janssen, E. T. Seidl,
    W. D. Allen, H. F. Schaefer, R. A. King, E. F. Valeev, C. D. Sherrill,
    and T. D. Crawford, WIREs Comput. Mol. Sci. 2, 556-565 (2012)
    (doi: 10.1002/wcms.93)

                         Additional Contributions by
    A. E. DePrince, U. Bozkaya, A. Yu. Sokolov, D. G. A. Smith, R. Di Remigio,
    R. M. Richard, J. F. Gonthier, H. R. McAlexander, M. Saitow, and
    B. P. Pritchard
    -----------------------------------------------------------------------


    Psi4 started on: Wed Jul 27 17:36:05 2016

    Process ID:  44415
    PSI4DATADIR: /Users/zxu66/src/psi4public/share
    Memory level set to 256.000 MB

  ==> Input File <==

--------------------------------------------------------------------------
#! Generated using commit GITCOMMIT

import forte
memory 500 mb

refdsrgpt2   = -100.023143001118669

molecule HF{
  0 1
  F
  H  1 R
  R = 1.00
}

set globals{
   basis                   cc-pvdz
   reference               rhf
   scf_type                pk
   d_convergence           12
   e_convergence           15
   docc                    [3,0,1,1]
}

set forte{
  job_type                active-dsrgpt2
  frozen_docc             [1,0,1,1]
  restricted_docc         [0,0,0,0]
  active                  [4,0,0,0]
  frozen_uocc             [5,1,3,3]
  nrootpi                 [1,0,0,0]
  dsrg_s                  1.0
  cas_type                cas
  active_space_type       cisd
  cisd_ex_no_hf           true
  internal_amp            true
  ntamp                   60
}

Escf, wfn = energy('scf', return_wfn=True)
Edsrg = energy('forte', ref_wfn=wfn)
compare_values(refdsrgpt2,get_variable("CURRENT ENERGY"),10,"DSRG-MRPT2 energy")

# now test CD-DSRG-MRPT2
set forte{
  int_type                cholesky
  cholesky_tolerance      8
}
energy('forte', ref_wfn=wfn)
compare_values(refdsrgpt2,get_variable("CURRENT ENERGY"),7,"CD-DSRG-MRPT2 energy")

# now do single reference DSRG-PT2
set forte{
  job_type                dsrg-mrpt2
  int_type                conventional
  frozen_docc             [1,0,1,1]
  restricted_docc         [2,0,0,0]
  active                  [0,0,0,0]
  frozen_uocc             [5,1,3,3]
}
Edsrg_sr = energy('forte', ref_wfn=wfn)
compare_values(Edsrg_sr,Edsrg,10,"DSRG-MRPT2 internal v.s. SR-DSRG-PT2")

--------------------------------------------------------------------------
/Users/zxu66/src/v2rdm_casscf/v2rdm_casscf.so loaded.
/Users/zxu66/src/forte/forte.so loaded.

  Memory set to 500.000 MiB by Python script.

*** tstart() called on che-zxu66-01i
*** at Wed Jul 27 17:36:06 2016


         ---------------------------------------------------------
                                   SCF
            by Justin Turney, Rob Parrish, and Andy Simmonett
                              RHF Reference
                        1 Threads,    500 MiB Core
         ---------------------------------------------------------

  ==> Geometry <==

    Molecular point group: c2v
    Full point group: C_inf_v

    Geometry (in Angstrom), charge = 0, multiplicity = 1:

       Center              X                  Y                   Z               Mass       
    ------------   -----------------  -----------------  -----------------  -----------------
           F          0.000000000000     0.000000000000    -0.050375564008    18.998403224000
           H          0.000000000000     0.000000000000     0.949624435992     1.007825032070

  Running in c2v symmetry.

  Rotational constants: A = ************  B =     17.61406  C =     17.61406 [cm^-1]
  Rotational constants: A = ************  B = 528056.23332  C = 528056.23332 [MHz]
  Nuclear repulsion =    4.762594877310000

  Charge       = 0
  Multiplicity = 1
  Electrons    = 10
  Nalpha       = 5
  Nbeta        = 5

  ==> Algorithm <==

  SCF Algorithm Type is PK.
  DIIS enabled.
  MOM disabled.
  Fractional occupation disabled.
  Guess Type is SAD.
  Energy threshold   = 1.00e-15
  Density threshold  = 1.00e-12
  Integral threshold = 0.00e+00

  ==> Primary Basis <==

  Basis Set: CC-PVDZ
    Number of shells: 9
    Number of basis function: 19
    Number of Cartesian functions: 20
    Spherical Harmonics?: true
    Max angular momentum: 2

  ==> Pre-Iterations <==

   -------------------------------------------------------
    Irrep   Nso     Nmo     Nalpha   Nbeta   Ndocc  Nsocc
   -------------------------------------------------------
     A1        10      10       3       3       3       0
     A2         1       1       0       0       0       0
     B1         4       4       1       1       1       0
     B2         4       4       1       1       1       0
   -------------------------------------------------------
    Total      19      19       5       5       5       0
   -------------------------------------------------------

  ==> Integral Setup <==

  Using in-core PK algorithm.
   Calculation information:
      Number of atoms:                   2
      Number of AO shells:               9
      Number of primitives:             27
      Number of atomic orbitals:        20
      Number of basis functions:        19

      Integral cutoff                 1.00e-12
      Number of threads:                 1

  Performing in-core PK
  Using 36290 doubles for integral storage.
  We computed 1035 shell quartets total.
  Whereas there are 1035 unique shell quartets.
  ==> DiskJK: Disk-Based J/K Matrices <==

    J tasked:                  Yes
    K tasked:                  Yes
    wK tasked:                  No
    Memory (MB):               357
    Schwarz Cutoff:          1E-12

    OpenMP threads:              1
  Minimum eigenvalue in the overlap matrix is 6.0264792605E-02.
  Using Symmetric Orthogonalization.
  SCF Guess: Superposition of Atomic Densities via on-the-fly atomic UHF.

  ==> Iterations <==

                        Total Energy        Delta E     RMS |[F,P]|

   @RHF iter   0:   -99.85079074898003   -9.98508e+01   8.86447e-02 
   @RHF iter   1:   -99.97358720518011   -1.22796e-01   2.46409e-02 
   @RHF iter   2:  -100.00252507117396   -2.89379e-02   1.33550e-02 DIIS
   @RHF iter   3:  -100.00936922921476   -6.84416e-03   2.04727e-03 DIIS
   @RHF iter   4:  -100.00982232914490   -4.53100e-04   6.57227e-04 DIIS
   @RHF iter   5:  -100.00986878847424   -4.64593e-05   9.24343e-05 DIIS
   @RHF iter   6:  -100.00987000833248   -1.21986e-06   1.36276e-05 DIIS
   @RHF iter   7:  -100.00987003204816   -2.37157e-08   1.69919e-06 DIIS
   @RHF iter   8:  -100.00987003232079   -2.72635e-10   2.07721e-07 DIIS
   @RHF iter   9:  -100.00987003232471   -3.92220e-12   1.63000e-08 DIIS
   @RHF iter  10:  -100.00987003232464    7.10543e-14   2.44791e-09 DIIS
   @RHF iter  11:  -100.00987003232481   -1.70530e-13   1.66495e-10 DIIS
   @RHF iter  12:  -100.00987003232478    2.84217e-14   1.24170e-11 DIIS
   @RHF iter  13:  -100.00987003232471    7.10543e-14   2.15883e-12 DIIS
   @RHF iter  14:  -100.00987003232478   -7.10543e-14   6.19285e-14 DIIS
   @RHF iter  15:  -100.00987003232484   -5.68434e-14   1.77940e-14 DIIS
   @RHF iter  16:  -100.00987003232471    1.27898e-13   8.01346e-15 DIIS
   @RHF iter  17:  -100.00987003232474   -2.84217e-14   3.48352e-15 DIIS
   @RHF iter  18:  -100.00987003232473    1.42109e-14   3.17101e-15 DIIS
   @RHF iter  19:  -100.00987003232476   -2.84217e-14   2.66388e-15 DIIS
   @RHF iter  20:  -100.00987003232483   -7.10543e-14   3.55880e-15 DIIS
   @RHF iter  21:  -100.00987003232481    1.42109e-14   2.95571e-15 DIIS
   @RHF iter  22:  -100.00987003232473    8.52651e-14   2.63098e-15 DIIS
   @RHF iter  23:  -100.00987003232477   -4.26326e-14   2.64420e-15 DIIS
   @RHF iter  24:  -100.00987003232471    5.68434e-14   2.78943e-15 DIIS
   @RHF iter  25:  -100.00987003232468    2.84217e-14   3.43365e-15 DIIS
   @RHF iter  26:  -100.00987003232473   -4.26326e-14   2.53770e-15 DIIS
   @RHF iter  27:  -100.00987003232477   -4.26326e-14   3.22749e-15 DIIS
   @RHF iter  28:  -100.00987003232474    2.84217e-14   2.28326e-15 DIIS
   @RHF iter  29:  -100.00987003232468    5.68434e-14   2.94537e-15 DIIS
   @RHF iter  30:  -100.00987003232470   -1.42109e-14   2.34382e-15 DIIS
   @RHF iter  31:  -100.00987003232481   -1.13687e-13   3.51160e-15 DIIS
   @RHF iter  32:  -100.00987003232474    7.10543e-14   2.80517e-15 DIIS
   @RHF iter  33:  -100.00987003232470    4.26326e-14   2.99926e-15 DIIS
   @RHF iter  34:  -100.00987003232477   -7.10543e-14   3.11771e-15 DIIS
   @RHF iter  35:  -100.00987003232474    2.84217e-14   2.92954e-15 DIIS
   @RHF iter  36:  -100.00987003232474    0.00000e+00   3.07167e-15 DIIS

  ==> Post-Iterations <==

    Orbital Energies (a.u.)
    -----------------------

    Doubly Occupied:                                                      

       1A1   -26.279280     2A1    -1.557452     3A1    -0.714908  
       1B2    -0.621198     1B1    -0.621198  

    Virtual:                                                              

       4A1     0.164493     5A1     0.737647     2B2     1.383060  
       2B1     1.383060     6A1     1.446649     3B2     1.616045  
       3B1     1.616045     7A1     2.133481     8A1     2.301792  
       9A1     4.012209     1A2     4.012209     4B1     4.207293  
       4B2     4.207293    10A1     4.935778  

    Final Occupation by Irrep:
             A1    A2    B1    B2 
    DOCC [     3,    0,    1,    1 ]

  Energy converged.

  @RHF Final Energy:  -100.00987003232474

   => Energetics <=

    Nuclear Repulsion Energy =              4.7625948773099998
    One-Electron Energy =                -149.9568562656195923
    Two-Electron Energy =                  45.1843913559848716
    DFT Exchange-Correlation Energy =       0.0000000000000000
    Empirical Dispersion Energy =           0.0000000000000000
    PCM Polarization Energy =               0.0000000000000000
    EFP Energy =                            0.0000000000000000
    Total Energy =                       -100.0098700323247272


  Saving occupied orbitals to File 180.

*** tstop() called on che-zxu66-01i at Wed Jul 27 17:36:06 2016
Module time:
	user time   =       0.24 seconds =       0.00 minutes
	system time =       0.02 seconds =       0.00 minutes
	total time  =          0 seconds =       0.00 minutes
Total time:
	user time   =       0.24 seconds =       0.00 minutes
	system time =       0.02 seconds =       0.00 minutes
	total time  =          0 seconds =       0.00 minutes


Properties will be evaluated at   0.000000,   0.000000,   0.000000 Bohr

Properties computed using the SCF density matrix

  Nuclear Dipole Moment: (a.u.)
     X:     0.0000      Y:     0.0000      Z:     0.9378

  Electronic Dipole Moment: (a.u.)
     X:     0.0000      Y:     0.0000      Z:    -0.1057

  Dipole Moment: (a.u.)
     X:     0.0000      Y:     0.0000      Z:     0.8320     Total:     0.8320

  Dipole Moment: (Debye)
     X:     0.0000      Y:     0.0000      Z:     2.1148     Total:     2.1148


Reading options from the FORTE block
Calling plugin /Users/zxu66/src/forte/forte.so.




  ==> MO Space Information <==

  Read options for space FROZEN_DOCC
  Read options for space RESTRICTED_DOCC
  Read options for space ACTIVE
  Read options for space FROZEN_UOCC
 Removing orbital 0
 Removing orbital 11
 Removing orbital 15
  -------------------------------------------------
                       A1    A2    B1    B2   Sum
  -------------------------------------------------
    FROZEN_DOCC         1     0     1     1     3
    RESTRICTED_DOCC     0     0     0     0     0
    ACTIVE              4     0     0     0     4
    RESTRICTED_UOCC     0     0     0     0     0
    FROZEN_UOCC         5     1     3     3    12
    Total              10     1     4     4    19
  -------------------------------------------------

  ==> Integral Transformation <==

  Number of molecular orbitals:               19
  Number of correlated molecular orbitals:     4
  Number of frozen occupied orbitals:          3
  Number of frozen unoccupied orbitals:       12


  Overall Conventional Integrals timings

	Presorting SO-basis two-electron integrals.
	Sorting File: SO Ints (nn|nn) nbuckets = 1
	Transforming the one-electron integrals and constructing Fock matrices
	Starting first half-transformation.
	Sorting half-transformed integrals.
	First half integral transformation complete.
	Starting second half-transformation.
	Two-electron integral transformation complete.

  Integral transformation done. 0.24310500 s
  Reading the two-electron integrals from disk
  Size of two-electron integrals:   0.002913 GB  Using in-core PK algorithm.
   Calculation information:
      Number of atoms:                   2
      Number of AO shells:               9
      Number of primitives:             27
      Number of atomic orbitals:        20
      Number of basis functions:        19

      Integral cutoff                 1.00e-12
      Number of threads:                 1

  Performing in-core PK
  Using 36290 doubles for integral storage.
  We computed 1035 shell quartets total.
  Whereas there are 1035 unique shell quartets.

  Frozen-core energy            -95.777625202108 a.u.

 FrozenOneBody Operator takes  0.05396400 s
  Resorting integrals after freezing core.
  Conventional integrals take 0.52312400 s

                               ------------------
                                 ACTIVE-DSRGPT2
                                  Chenyang Li
                               ------------------

    The orbitals are fixed throughout the process.
    If different orbitals (or reference) are desired for different roots,
    you need to run those separately using the regular DSRG-MRPT2 / MRPT3 (or DF/CD) code.

                A1    A2    B1    B2
    ----------------------------------
      NROOTS     1     0     0     0
    ----------------------------------

  ==> Input Summary <==

    number of atoms                =     2
    number of electrons            =    10
    molecular charge               =     0
    number of alpha electrons      =     5
    number of beta electrons       =     5
    multiplicity                   =     1
    ms (2 * Sz)                    =     0
    number of molecular orbitals   =    19

  ==> Orbital Spaces <==

    TOTAL MO                      [   10     1     4     4 ]
    FROZEN CORE                   [    1     0     1     1 ]
    FROZEN VIRTUAL                [    5     1     3     3 ]
    CORRELATED MO                 [    4     0     0     0 ]
    CORE                          [    0     0     0     0 ]
    ACTIVE                        [    4     0     0     0 ]
    VIRTUAL                       [    0     0     0     0 ]

  ==> Correlated Subspace Indices <==

    CORE                          
    ACTIVE                           0    1    2    3 
    HOLE                             0    1    2    3 
    VIRTUAL                       
    PARTICLE                         0    1    2    3 


  ===================================
    Current Job:  A1 state, root  0
  ===================================


  ==> Determinants Summary <==

    number of alpha active electrons    =     2
    number of beta active electrons     =     2
    root symmetry (zero based)          =     0
    number of determinants              =     1

  ==> Determinants |alpha|beta> <==
  
  |2200>


  Diagonalizing Hamiltonian           ...

  Reference type: RHF
  Threshold for spin check: 0.10

  Spin State: S^2 = 0.000, S = 0.000, singlet (from 1 determinants)  Done. Timing        0.000052 s

  * * * * * * * * * * * * * * * * *
  *  CI Vectors & Configurations  *
  * * * * * * * * * * * * * * * * *

  ==> Root No. 0 <==

    2200          1.0000000000

    Total Energy:   -100.009870032324756


  Forming one-particle density        ...  Done. Timing        0.000030 s
  Forming generalized Fock matrix     ...  Done. Timing        0.000007 s
  Checking Fock matrices (Fa, Fb)     ...
  Nonzero criteria: > 1.00E-12
  Fa_CORE    block is diagonal.
  Fb_CORE    block is diagonal.
  Fa_ACT_O   block is diagonal.
  Fb_ACT_O   block is diagonal.
  Fa_ACT_V   block is diagonal.
  Fb_ACT_V   block is diagonal.
  Fa_VIRTUAL block is diagonal.
  Fb_VIRTUAL block is diagonal.
  Done checking Fock matrices.                   Timing        0.000065 s

  Forming Lambda2                     ...  Done. Timing        0.000081 s
  Forming Lambda3                     ...  Done. Timing        0.001871 s

              ----------------------------------------------------
                 Driven Similarity Renormalization Group MBPT2
                Chenyang Li, Kevin Hannon, Francesco Evangelista
              ----------------------------------------------------

    Reference:
      J. Chem. Theory Comput. 2015, 11, 2097-2108.

  ==> Calculation Information <==

    ntamp                                           60
    flow parameter                           1.000e+00
    taylor expansion threshold               1.000e-03
    intruder_tamp                            1.000e-01
    int_type                                CONVENTIONAL
    source operator                           STANDARD
    reference relaxation                          NONE

  ==> Checking Orbitals <==

    Checking if orbitals are semi-canonicalized ...     OK.
    Orbitals are semi-canonicalized.

  ==> Computing DSRG-MRPT2 ... <==

    Computing T2 amplitudes                  ...  Done. Timing        0.001388 s
    Computing T1 amplitudes                  ...  Done. Timing        0.001320 s
    Renormalizing two-electron integrals     ...  Done. Timing        0.000237 s
    Renormalizing Fock matrix elements       ...  Done. Timing        0.001384 s
    Computing <[F, T1]>                      ...  Done. Timing        0.001362 s
    Computing <[F, T2]>                      ...  Done. Timing        0.003492 s
    Computing <[V, T1]>                      ...  Done. Timing        0.003406 s
    Computing <[V, T2]> (C_2)^4              ...  Done. Timing        0.017631 s
    Computing <[V, T2]> C_4 (C_2)^2 HH       ...  Done. Timing        0.006536 s
    Computing <[V, T2]> C_4 (C_2)^2 PP       ...  Done. Timing        0.005728 s
    Computing <[V, T2]> C_4 (C_2)^2 PH       ...  Done. Timing        0.018055 s
    Computing <[V, T2]> C_6 C_2              ...  Done. Timing        0.010967 s

  ==> Excitation Amplitudes Summary <==

    Active Indices:    0    1    2    3 


    Largest T2 amplitudes for spin case AA:
       i   j   a   b              i   j   a   b              i   j   a   b           
    --------------------------------------------------------------------------------
    [  0   1   0   2] 0.052146 [  0   2   0   3] 0.051009 [  0   1   1   2] 0.048390 
    [  0   1   0   3]-0.044484 [  1   2   1   3] 0.034629 [  0   3   1   3] 0.033599 
    [  0   1   1   3]-0.031332 [  1   2   2   3]-0.023293 [  0   3   2   3]-0.015646 
    [  0   2   1   2] 0.012412 [  0   2   2   3] 0.008202 [  0   2   1   3]-0.001805 
    [  0   3   1   2]-0.000553 [  0   1   2   3]-0.000259 [  1   3   2   3]-0.000153 
    --------------------------------------------------------------------------------
    Norm of T2AA vector: (nonzero elements: 61)                   0.236335531122435.
    --------------------------------------------------------------------------------
    Largest T2 amplitudes for spin case AB:
           _       _                  _       _                  _       _           
       i   j   a   b              i   j   a   b              i   j   a   b           
    --------------------------------------------------------------------------------
    [  0   0   1   1]-0.090212 [  0   1   0   2] 0.073828 [  2   3   3   3] 0.070106 
    [  1   3   3   3] 0.067501 [  1   2   1   3] 0.066994 [  0   2   0   3] 0.065678 
    [  0   1   0   3]-0.060352 [  1   1   1   2] 0.059416 [  0   0   0   2]-0.057299 
    [  0   3   1   3] 0.052616 [  1   1   3   3]-0.041071 [  2   2   3   3]-0.040622 
    [  1   1   1   3]-0.040573 [  0   3   1   1] 0.038920 [  0   1   1   3]-0.033120 
    [  1   1   2   2]-0.029849 [  2   2   2   3] 0.029546 [  0   2   1   2] 0.029137 
    [  1   1   2   3] 0.028286 [  0   0   0   3] 0.020107 [  0   1   1   1]-0.017211 
    [  0   3   3   3]-0.017113 [  0   2   1   3]-0.014730 [  0   1   1   2] 0.014208 
    [  0   0   1   2] 0.013787 [  1   3   2   3]-0.013499 [  0   3   2   3]-0.011990 
    [  0   3   2   2] 0.011245 [  0   0   2   2]-0.010922 [  0   1   2   2] 0.010645 
    [  1   2   3   3]-0.010580 [  0   2   2   2]-0.010358 [  0   1   3   3] 0.008411 
    [  0   0   3   3]-0.008388 [  0   0   1   3]-0.008359 [  0   2   2   3] 0.007641 
    [  0   0   2   3] 0.007475 [  0   1   2   3]-0.006921 [  1   2   2   2]-0.006497 
    [  0   3   1   2]-0.006262 [  1   2   2   3]-0.005235 [  0   0   0   1]-0.003404 
    [  1   3   2   2]-0.002530 [  0   2   3   3] 0.002313 [  0   2   1   1]-0.000950 
    --------------------------------------------------------------------------------
    Norm of T2AB vector: (nonzero elements: 115)                  0.338787150634836.
    --------------------------------------------------------------------------------
    Largest T2 amplitudes for spin case BB:
       _   _   _   _              _   _   _   _              _   _   _   _           
       i   j   a   b              i   j   a   b              i   j   a   b           
    --------------------------------------------------------------------------------
    [  0   1   0   2] 0.052146 [  0   2   0   3] 0.051009 [  0   1   1   2] 0.048390 
    [  0   1   0   3]-0.044484 [  1   2   1   3] 0.034629 [  0   3   1   3] 0.033599 
    [  0   1   1   3]-0.031332 [  1   2   2   3]-0.023293 [  0   3   2   3]-0.015646 
    [  0   2   1   2] 0.012412 [  0   2   2   3] 0.008202 [  0   2   1   3]-0.001805 
    [  0   3   1   2]-0.000553 [  0   1   2   3]-0.000259 [  1   3   2   3]-0.000153 
    --------------------------------------------------------------------------------
    Norm of T2BB vector: (nonzero elements: 61)                   0.236335531122435.
    --------------------------------------------------------------------------------

  ==> Possible Intruders <==

    T1 amplitudes larger than 0.1000 for spin case A: NULL
    T1 amplitudes larger than 0.1000 for spin case B: NULL
    T2 amplitudes larger than 0.1000 for spin case AA: NULL
    T2 amplitudes larger than 0.1000 for spin case AB: NULL
    T2 amplitudes larger than 0.1000 for spin case BB: NULL

  ==> DSRG-MRPT2 Energy Summary <==

    E0 (reference)                 =   -100.009870032324756
    <[F, T1]>                      =      0.000000000000000
    <[F, T2]>                      =      0.000000000000000
    <[V, T1]>                      =      0.000000000000000
    <[V, T2]> (C_2)^4              =     -0.013272968793856
    <[V, T2]> C_4 (C_2)^2 HH       =      0.000000000000000
    <[V, T2]> C_4 (C_2)^2 PP       =      0.000000000000000
    <[V, T2]> C_4 (C_2)^2 PH       =      0.000000000000000
    <[V, T2]> C_6 C_2              =      0.000000000000000
    <[V, T2]>                      =     -0.013272968793856
    DSRG-MRPT2 correlation energy  =     -0.013272968793856
    DSRG-MRPT2 total energy        =   -100.023143001118612
    max(T1)                        =      0.000000000000000
    max(T2)                        =      0.090212272135012
    ||T1||                         =      0.000000000000000
    ||T2||                         =      0.755523593465439

  Energy took 0.07318600 s

  ==> Total Timings (s) for Computing Commutators <==

             [H1, T1]    [H1, T2]    [H2, T1]    [H2, T2]
    -----------------------------------------------------
    -> C0       0.001       0.004       0.003       0.059
    -> C1       0.000       0.000       0.000       0.000
    -> C2                   0.000       0.000       0.000
    -----------------------------------------------------


  ==> ACTIVE-DSRGPT2 Summary <==

    Sym.    ROOT         CISD                 PT2
    ----------------------------------------------------
      A1       0     -100.0098700323     -100.0231430011
    ----------------------------------------------------

  Your calculation took 0.62853900 seconds
	DSRG-MRPT2 energy.................................................PASSED

Reading options from the FORTE block
Calling plugin /Users/zxu66/src/forte/forte.so.




  ==> MO Space Information <==

  Read options for space FROZEN_DOCC
  Read options for space RESTRICTED_DOCC
  Read options for space ACTIVE
  Read options for space FROZEN_UOCC
 Removing orbital 0
 Removing orbital 11
 Removing orbital 15
  -------------------------------------------------
                       A1    A2    B1    B2   Sum
  -------------------------------------------------
    FROZEN_DOCC         1     0     1     1     3
    RESTRICTED_DOCC     0     0     0     0     0
    ACTIVE              4     0     0     0     4
    RESTRICTED_UOCC     0     0     0     0     0
    FROZEN_UOCC         5     1     3     3    12
    Total              10     1     4     4    19
  -------------------------------------------------

  ==> Integral Transformation <==

  Number of molecular orbitals:               19
  Number of correlated molecular orbitals:     4
  Number of frozen occupied orbitals:          3
  Number of frozen unoccupied orbitals:       12


  Cholesky integrals time
 Computing the Cholesky Vectors 

    Computing CD Integrals               ......Done. Timing        0.079491 s
 Need 0.000430 GB to store cd integrals in core

 Number of cholesky vectors 160 to satisfy       0.000000010000 tolerance
  Using in-core PK algorithm.
   Calculation information:
      Number of atoms:                   2
      Number of AO shells:               9
      Number of primitives:             27
      Number of atomic orbitals:        20
      Number of basis functions:        19

      Integral cutoff                 1.00e-12
      Number of threads:                 1

  Performing in-core PK
  Using 36290 doubles for integral storage.
  We computed 1035 shell quartets total.
  Whereas there are 1035 unique shell quartets.

  Frozen-core energy            -95.777625202108 a.u.

 FrozenOneBody Operator takes  0.05808700 s
  Resorting integrals after freezing core.
  CholeskyIntegrals take 0.15102300

                               ------------------
                                 ACTIVE-DSRGPT2
                                  Chenyang Li
                               ------------------

    The orbitals are fixed throughout the process.
    If different orbitals (or reference) are desired for different roots,
    you need to run those separately using the regular DSRG-MRPT2 / MRPT3 (or DF/CD) code.

                A1    A2    B1    B2
    ----------------------------------
      NROOTS     1     0     0     0
    ----------------------------------

  ==> Input Summary <==

    number of atoms                =     2
    number of electrons            =    10
    molecular charge               =     0
    number of alpha electrons      =     5
    number of beta electrons       =     5
    multiplicity                   =     1
    ms (2 * Sz)                    =     0
    number of molecular orbitals   =    19

  ==> Orbital Spaces <==

    TOTAL MO                      [   10     1     4     4 ]
    FROZEN CORE                   [    1     0     1     1 ]
    FROZEN VIRTUAL                [    5     1     3     3 ]
    CORRELATED MO                 [    4     0     0     0 ]
    CORE                          [    0     0     0     0 ]
    ACTIVE                        [    4     0     0     0 ]
    VIRTUAL                       [    0     0     0     0 ]

  ==> Correlated Subspace Indices <==

    CORE                          
    ACTIVE                           0    1    2    3 
    HOLE                             0    1    2    3 
    VIRTUAL                       
    PARTICLE                         0    1    2    3 


  ===================================
    Current Job:  A1 state, root  0
  ===================================


  ==> Determinants Summary <==

    number of alpha active electrons    =     2
    number of beta active electrons     =     2
    root symmetry (zero based)          =     0
    number of determinants              =     1

  ==> Determinants |alpha|beta> <==
  
  |2200>


  Diagonalizing Hamiltonian           ...

  Reference type: RHF
  Threshold for spin check: 0.10

  Spin State: S^2 = 0.000, S = 0.000, singlet (from 1 determinants)  Done. Timing        0.000033 s

  * * * * * * * * * * * * * * * * *
  *  CI Vectors & Configurations  *
  * * * * * * * * * * * * * * * * *

  ==> Root No. 0 <==

    2200          1.0000000000

    Total Energy:   -100.009870032255293


  Forming one-particle density        ...  Done. Timing        0.000013 s
  Forming generalized Fock matrix     ...  Done. Timing        0.000763 s
  Checking Fock matrices (Fa, Fb)     ...
  Nonzero criteria: > 1.00E-12
  Fa_CORE    block is diagonal.
  Fb_CORE    block is diagonal.
  Warning: Fa_ACT_O   NOT diagonal!
  Nonzero off-diagonal:     2. Largest value:  0.000000000008017
  Warning: Fb_ACT_O   NOT diagonal!
  Nonzero off-diagonal:     2. Largest value:  0.000000000008017
  Warning: Fa_ACT_V   NOT diagonal!
  Nonzero off-diagonal:     2. Largest value:  0.000000000589380
  Warning: Fb_ACT_V   NOT diagonal!
  Nonzero off-diagonal:     2. Largest value:  0.000000000589380
  Fa_VIRTUAL block is diagonal.
  Fb_VIRTUAL block is diagonal.
  Done checking Fock matrices.                   Timing        0.000069 s

  Use semi-canonical orbitals.

  Diagonalizing Fock                  ...  Done. Timing        0.000061 s



 Computing the Cholesky Vectors 

    Computing CD Integrals               ......Done. Timing        0.072783 s
 Need 0.000430 GB to store cd integrals in core

 Number of cholesky vectors 160 to satisfy       0.000000010000 tolerance
  Using in-core PK algorithm.
   Calculation information:
      Number of atoms:                   2
      Number of AO shells:               9
      Number of primitives:             27
      Number of atomic orbitals:        20
      Number of basis functions:        19

      Integral cutoff                 1.00e-12
      Number of threads:                 1

  Performing in-core PK
  Using 36290 doubles for integral storage.
  We computed 1035 shell quartets total.
  Whereas there are 1035 unique shell quartets.

  Frozen-core energy            -95.777625202108 a.u.

 FrozenOneBody Operator takes  0.04945200 s
  Resorting integrals after freezing core.
  Frozen Orbitals takes     0.050 s.
  Diagonalizing Hamiltonian           ...

  Reference type: RHF
  Threshold for spin check: 0.10

  Spin State: S^2 = 0.000, S = 0.000, singlet (from 1 determinants)  Done. Timing        0.000039 s

  * * * * * * * * * * * * * * * * *
  *  CI Vectors & Configurations  *
  * * * * * * * * * * * * * * * * *

  ==> Root No. 0 <==

    2200          1.0000000000

    Total Energy:   -100.009870032255265


  Forming one-particle density        ...  Done. Timing        0.000017 s
  Forming generalized Fock matrix     ...  Done. Timing        0.000941 s
  Checking Fock matrices (Fa, Fb)     ...
  Nonzero criteria: > 1.00E-12
  Fa_CORE    block is diagonal.
  Fb_CORE    block is diagonal.
  Fa_ACT_O   block is diagonal.
  Fb_ACT_O   block is diagonal.
  Fa_ACT_V   block is diagonal.
  Fb_ACT_V   block is diagonal.
  Fa_VIRTUAL block is diagonal.
  Fb_VIRTUAL block is diagonal.
  Done checking Fock matrices.                   Timing        0.000055 s

  Forming Lambda2                     ...  Done. Timing        0.000085 s
  Forming Lambda3                     ...  Done. Timing        0.001858 s

           ---------------------------------------------------------
             DF/CD - Driven Similarity Renormalization Group MBPT2
                      Kevin Hannon and Chenyang (York) Li
                                   1 thread
           ---------------------------------------------------------

  Reference = RHF
  Reference Energy = -100.009870032255265

  ==> Checking Orbitals <==

    Checking if orbitals are semi-canonicalized ...     OK.
    Orbitals are semi-canonicalized.

  ==> Calculation Information <==

    Flow parameter                           1.000e+00
    Cholesky Tolerance                       1.000e-08
    Taylor expansion threshold               1.000e-03
    int_type                                  CHOLESKY
    ccvv_algorithm                           FLY_AMBIT
    ccvv_source                                 NORMAL
    Computing T2                          ......Done. Timing        0.001444 s
    Renormalizing V                       ......Done. Timing        0.000204 s
    Computing T1                          ......Done. Timing        0.001784 s
    Renormalizing F                       ......Done. Timing        0.002319 s
    Computing <[F, T1]>                   ......Done. Timing        0.001734 s
    Computing <[F, T2]>                   ......Done. Timing        0.003356 s
    Computing <[V, T1]>                   ......Done. Timing        0.003972 s
    Computing <[V, T2]> (C_2)^4 (no ccvv) ......Done. Timing        0.011657 s
    Computing <[V, T2]> (C_2)^4 ccvv      ......Done. Timing        0.000068 s
    Computing <[V, T2]> 4HH               ......Done. Timing        0.008633 s
    Computing <V, T2]> 4PP                ......Done. Timing        0.006487 s
    Computing [V, T2] 4PH                 ......Done. Timing        0.017943 s
    Computing [V, T2] Î»3                  ......Done. Timing        0.008936 s

  ==> DSRG-MRPT2 Energy Summary <==

    E0 (reference)                 =   -100.009870032255265
    <[F, T1]>                      =     -0.000000000000000
    <[F, T2]>                      =      0.000000000000000
    <[V, T1]>                      =      0.000000000000000
    <[V, T2]> (C_2)^4              =     -0.013272968761356
    <[V, T2]> C_4 (C_2)^2 HH       =      0.000000000000000
    <[V, T2]> C_4 (C_2)^2 PP       =      0.000000000000000
    <[V, T2]> C_4 (C_2)^2 PH       =      0.000000000000000
    <[V, T2]> C_6 C_2              =      0.000000000000000
    <[V, T2]>                      =     -0.013272968761356
    DSRG-MRPT2 correlation energy  =     -0.013272968761356
    DSRG-MRPT2 total energy        =   -100.023143001016621
    max(T1)                        =      0.000000000071744
    ||T1||                         =      0.000000000116973

  CD/DF-DSRG-MRPT2 took   0.07641100 s.

  ==> Total Timings (s) for Computing Commutators <==

             [H1, T1]    [H1, T2]    [H2, T1]    [H2, T2]
    -----------------------------------------------------
    -> C0       0.002       0.003       0.004       0.052
    -> C1       0.000       0.000       0.000       0.000
    -> C2                   0.000       0.000       0.000
    -----------------------------------------------------


  ==> ACTIVE-DSRGPT2 Summary <==

    Sym.    ROOT         CISD                 PT2
    ----------------------------------------------------
      A1       0     -100.0098700323     -100.0231430010
    ----------------------------------------------------

  Your calculation took 0.43197900 seconds
	CD-DSRG-MRPT2 energy..............................................PASSED

Reading options from the FORTE block
Calling plugin /Users/zxu66/src/forte/forte.so.




  ==> MO Space Information <==

  Read options for space FROZEN_DOCC
  Read options for space RESTRICTED_DOCC
  Read options for space ACTIVE
  Read options for space FROZEN_UOCC
 Removing orbital 0
 Removing orbital 11
 Removing orbital 15
  -------------------------------------------------
                       A1    A2    B1    B2   Sum
  -------------------------------------------------
    FROZEN_DOCC         1     0     1     1     3
    RESTRICTED_DOCC     2     0     0     0     2
    ACTIVE              0     0     0     0     0
    RESTRICTED_UOCC     2     0     0     0     2
    FROZEN_UOCC         5     1     3     3    12
    Total              10     1     4     4    19
  -------------------------------------------------

  ==> Integral Transformation <==

  Number of molecular orbitals:               19
  Number of correlated molecular orbitals:     4
  Number of frozen occupied orbitals:          3
  Number of frozen unoccupied orbitals:       12


  Overall Conventional Integrals timings

	Presorting SO-basis two-electron integrals.
	Sorting File: SO Ints (nn|nn) nbuckets = 1
	Transforming the one-electron integrals and constructing Fock matrices
	Starting first half-transformation.
	Sorting half-transformed integrals.
	First half integral transformation complete.
	Starting second half-transformation.
	Two-electron integral transformation complete.

  Integral transformation done. 0.31284000 s
  Reading the two-electron integrals from disk
  Size of two-electron integrals:   0.002913 GB  Using in-core PK algorithm.
   Calculation information:
      Number of atoms:                   2
      Number of AO shells:               9
      Number of primitives:             27
      Number of atomic orbitals:        20
      Number of basis functions:        19

      Integral cutoff                 1.00e-12
      Number of threads:                 1

  Performing in-core PK
  Using 36290 doubles for integral storage.
  We computed 1035 shell quartets total.
  Whereas there are 1035 unique shell quartets.

  Frozen-core energy            -95.777625202108 a.u.

 FrozenOneBody Operator takes  0.05072400 s
  Resorting integrals after freezing core.
  Conventional integrals take 0.56825400 s

  ==> Input Summary <==

    number of atoms                =     2
    number of electrons            =    10
    molecular charge               =     0
    number of alpha electrons      =     5
    number of beta electrons       =     5
    multiplicity                   =     1
    ms (2 * Sz)                    =     0
    number of molecular orbitals   =    19

  ==> Orbital Spaces <==

    TOTAL MO                      [   10     1     4     4 ]
    FROZEN CORE                   [    1     0     1     1 ]
    FROZEN VIRTUAL                [    5     1     3     3 ]
    CORRELATED MO                 [    4     0     0     0 ]
    CORE                          [    2     0     0     0 ]
    ACTIVE                        [    0     0     0     0 ]
    VIRTUAL                       [    2     0     0     0 ]

  ==> Correlated Subspace Indices <==

    CORE                             0    1 
    ACTIVE                        
    HOLE                             0    1 
    VIRTUAL                          2    3 
    PARTICLE                         2    3 


  ==> Determinants Summary <==

    number of alpha active electrons    =     0
    number of beta active electrons     =     0
    root symmetry (zero based)          =     0
    number of determinants              =     1

  ==> Determinants |alpha|beta> <==
  
  |>


  Diagonalizing Hamiltonian           ...

  Reference type: RHF
  Threshold for spin check: 0.10

  Spin State: S^2 = 0.000, S = 0.000, singlet (from 1 determinants)  Done. Timing        0.000034 s

  * * * * * * * * * * * * * * * * *
  *  CI Vectors & Configurations  *
  * * * * * * * * * * * * * * * * *

  ==> Root No. 0 <==

             1.0000000000

    Total Energy:   -100.009870032324713


  Forming one-particle density        ...  Done. Timing        0.000008 s
  Forming generalized Fock matrix     ...  Done. Timing        0.000007 s
  Checking Fock matrices (Fa, Fb)     ...
  Nonzero criteria: > 1.00E-12
  Warning: Fa_CORE    NOT diagonal!
  Nonzero off-diagonal:     2. Largest value:  0.000000000008018
  Warning: Fb_CORE    NOT diagonal!
  Nonzero off-diagonal:     2. Largest value:  0.000000000008018
  Fa_ACT_O   block is diagonal.
  Fb_ACT_O   block is diagonal.
  Fa_ACT_V   block is diagonal.
  Fb_ACT_V   block is diagonal.
  Warning: Fa_VIRTUAL NOT diagonal!
  Nonzero off-diagonal:     2. Largest value:  0.000000000589379
  Warning: Fb_VIRTUAL NOT diagonal!
  Nonzero off-diagonal:     2. Largest value:  0.000000000589379
  Done checking Fock matrices.                   Timing        0.000056 s

  Use semi-canonical orbitals.

  Diagonalizing Fock                  ...  Done. Timing        0.000045 s


	Presorting SO-basis two-electron integrals.
	Sorting File: SO Ints (nn|nn) nbuckets = 1
	Transforming the one-electron integrals and constructing Fock matrices
	Starting first half-transformation.
	Sorting half-transformed integrals.
	First half integral transformation complete.
	Starting second half-transformation.
	Two-electron integral transformation complete.

  Integral transformation done. 0.23174300 s
  Reading the two-electron integrals from disk
  Size of two-electron integrals:   0.002913 GB  Using in-core PK algorithm.
   Calculation information:
      Number of atoms:                   2
      Number of AO shells:               9
      Number of primitives:             27
      Number of atomic orbitals:        20
      Number of basis functions:        19

      Integral cutoff                 1.00e-12
      Number of threads:                 1

  Performing in-core PK
  Using 36290 doubles for integral storage.
  We computed 1035 shell quartets total.
  Whereas there are 1035 unique shell quartets.

  Frozen-core energy            -95.777625202108 a.u.

 FrozenOneBody Operator takes  0.04883100 s
  Resorting integrals after freezing core.
  Frozen Orbitals takes     0.049 s.
  Diagonalizing Hamiltonian           ...

  Reference type: RHF
  Threshold for spin check: 0.10

  Spin State: S^2 = 0.000, S = 0.000, singlet (from 1 determinants)  Done. Timing        0.000041 s

  * * * * * * * * * * * * * * * * *
  *  CI Vectors & Configurations  *
  * * * * * * * * * * * * * * * * *

  ==> Root No. 0 <==

             1.0000000000

    Total Energy:   -100.009870032324713


  Forming one-particle density        ...  Done. Timing        0.000009 s
  Forming generalized Fock matrix     ...  Done. Timing        0.000008 s
  Checking Fock matrices (Fa, Fb)     ...
  Nonzero criteria: > 1.00E-12
  Fa_CORE    block is diagonal.
  Fb_CORE    block is diagonal.
  Fa_ACT_O   block is diagonal.
  Fb_ACT_O   block is diagonal.
  Fa_ACT_V   block is diagonal.
  Fb_ACT_V   block is diagonal.
  Fa_VIRTUAL block is diagonal.
  Fb_VIRTUAL block is diagonal.
  Done checking Fock matrices.                   Timing        0.000047 s

  Forming Lambda2                     ...  Done. Timing        0.000009 s
  Forming Lambda3                     ...  Done. Timing        0.000010 s

              ----------------------------------------------------
                 Driven Similarity Renormalization Group MBPT2
                Chenyang Li, Kevin Hannon, Francesco Evangelista
              ----------------------------------------------------

    Reference:
      J. Chem. Theory Comput. 2015, 11, 2097-2108.

  ==> Calculation Information <==

    ntamp                                           60
    flow parameter                           1.000e+00
    taylor expansion threshold               1.000e-03
    intruder_tamp                            1.000e-01
    int_type                                CONVENTIONAL
    source operator                           STANDARD
    reference relaxation                          NONE

  ==> Checking Orbitals <==

    Checking if orbitals are semi-canonicalized ...     OK.
    Orbitals are semi-canonicalized.

  ==> Computing DSRG-MRPT2 ... <==

    Computing T2 amplitudes                  ...  Done. Timing        0.000905 s
    Computing T1 amplitudes                  ...  Done. Timing        0.001119 s
    Renormalizing two-electron integrals     ...  Done. Timing        0.000129 s
    Renormalizing Fock matrix elements       ...  Done. Timing        0.001444 s
    Computing <[F, T1]>                      ...  Done. Timing        0.001960 s
    Computing <[F, T2]>                      ...  Done. Timing        0.005085 s
    Computing <[V, T1]>                      ...  Done. Timing        0.004234 s
    Computing <[V, T2]> (C_2)^4              ...  Done. Timing        0.016599 s
    Computing <[V, T2]> C_4 (C_2)^2 HH       ...  Done. Timing        0.004503 s
    Computing <[V, T2]> C_4 (C_2)^2 PP       ...  Done. Timing        0.004452 s
    Computing <[V, T2]> C_4 (C_2)^2 PH       ...  Done. Timing        0.017785 s
    Computing <[V, T2]> C_6 C_2              ...  Done. Timing        0.008692 s

  ==> Excitation Amplitudes Summary <==

    Active Indices: 


    Largest T2 amplitudes for spin case AA:
       i   j   a   b              i   j   a   b              i   j   a   b           
    --------------------------------------------------------------------------------
    [  0   1   2   3]-0.000259 
    --------------------------------------------------------------------------------
    Norm of T2AA vector: (nonzero elements: 4)                    0.000518574969720.
    --------------------------------------------------------------------------------
    Largest T2 amplitudes for spin case AB:
           _       _                  _       _                  _       _           
       i   j   a   b              i   j   a   b              i   j   a   b           
    --------------------------------------------------------------------------------
    [  1   1   3   3]-0.041071 [  1   1   2   2]-0.029849 [  1   1   2   3] 0.028286 
    [  0   0   2   2]-0.010922 [  0   1   2   2] 0.010645 [  0   1   3   3] 0.008411 
    [  0   0   3   3]-0.008388 [  0   0   2   3] 0.007475 [  0   1   2   3]-0.006921 
    --------------------------------------------------------------------------------
    Norm of T2AB vector: (nonzero elements: 16)                   0.070937500214216.
    --------------------------------------------------------------------------------
    Largest T2 amplitudes for spin case BB:
       _   _   _   _              _   _   _   _              _   _   _   _           
       i   j   a   b              i   j   a   b              i   j   a   b           
    --------------------------------------------------------------------------------
    [  0   1   2   3]-0.000259 
    --------------------------------------------------------------------------------
    Norm of T2BB vector: (nonzero elements: 4)                    0.000518574969720.
    --------------------------------------------------------------------------------

  ==> Possible Intruders <==

    T1 amplitudes larger than 0.1000 for spin case A: NULL
    T1 amplitudes larger than 0.1000 for spin case B: NULL
    T2 amplitudes larger than 0.1000 for spin case AA: NULL
    T2 amplitudes larger than 0.1000 for spin case AB: NULL
    T2 amplitudes larger than 0.1000 for spin case BB: NULL

  ==> DSRG-MRPT2 Energy Summary <==

    E0 (reference)                 =   -100.009870032324713
    <[F, T1]>                      =      0.000000000000000
    <[F, T2]>                      =      0.000000000000000
    <[V, T1]>                      =      0.000000000000000
    <[V, T2]> (C_2)^4              =     -0.013272968793856
    <[V, T2]> C_4 (C_2)^2 HH       =      0.000000000000000
    <[V, T2]> C_4 (C_2)^2 PP       =      0.000000000000000
    <[V, T2]> C_4 (C_2)^2 PH       =      0.000000000000000
    <[V, T2]> C_6 C_2              =      0.000000000000000
    <[V, T2]>                      =     -0.013272968793856
    DSRG-MRPT2 correlation energy  =     -0.013272968793856
    DSRG-MRPT2 total energy        =   -100.023143001118569
    max(T1)                        =      0.000000000000000
    max(T2)                        =      0.041071009724217
    ||T1||                         =      0.000000000000000
    ||T2||                         =      0.141876895887125

  Energy took 0.06819900 s

  ==> Total Timings (s) for Computing Commutators <==

             [H1, T1]    [H1, T2]    [H2, T1]    [H2, T2]
    -----------------------------------------------------
    -> C0       0.002       0.005       0.004       0.052
    -> C1       0.000       0.000       0.000       0.000
    -> C2                   0.000       0.000       0.000
    -----------------------------------------------------


  Your calculation took 1.16856700 seconds
	DSRG-MRPT2 internal v.s. SR-DSRG-PT2..............................PASSED

*** Psi4 exiting successfully. Buy a developer a beer!
