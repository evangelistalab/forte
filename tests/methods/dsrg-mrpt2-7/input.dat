#! Generated using commit GITCOMMIT

import forte
memory 500 mb

refdsrgpt2   = -100.023143001118669

molecule HF{
  0 1
  F
  H  1 R
  R = 1.00
}

set globals{
   basis                   cc-pvdz
   reference               rhf
   scf_type                pk
   d_convergence           12
   e_convergence           15
   docc                    [3,0,1,1]
}

set forte{
  job_type                active-dsrgpt2
  frozen_docc             [1,0,1,1]
  restricted_docc         [0,0,0,0]
  active                  [4,0,0,0]
  frozen_uocc             [5,1,3,3]
  nrootpi                 [1,0,0,0]
  dsrg_s                  1.0
  cas_type                cas
  active_space_type       cisd
  cisd_ex_no_hf           true
  internal_amp            true
  ntamp                   60
}

Escf, wfn = energy('scf', return_wfn=True)
Edsrg = energy('forte', ref_wfn=wfn)
compare_values(refdsrgpt2,get_variable("CURRENT ENERGY"),10,"DSRG-MRPT2 energy")

# now do single reference DSRG-PT2
set forte{
  job_type                dsrg-mrpt2
  frozen_docc             [1,0,1,1]
  restricted_docc         [2,0,0,0]
  active                  [0,0,0,0]
  frozen_uocc             [5,1,3,3]
}
Edsrg_sr = energy('forte', ref_wfn=wfn)
compare_values(Edsrg_sr,Edsrg,10,"DSRG-MRPT2 internal v.s. SR-DSRG-PT2")
