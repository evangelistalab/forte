
    -----------------------------------------------------------------------
          Psi4: An Open-Source Ab Initio Electronic Structure Package
                               Psi4 1.4rc3.dev3 

                         Git: Rev {master} 10a2019 


    D. G. A. Smith, L. A. Burns, A. C. Simmonett, R. M. Parrish,
    M. C. Schieber, R. Galvelis, P. Kraus, H. Kruse, R. Di Remigio,
    A. Alenaizan, A. M. James, S. Lehtola, J. P. Misiewicz, M. Scheurer,
    R. A. Shaw, J. B. Schriber, Y. Xie, Z. L. Glick, D. A. Sirianni,
    J. S. O'Brien, J. M. Waldrop, A. Kumar, E. G. Hohenstein,
    B. P. Pritchard, B. R. Brooks, H. F. Schaefer III, A. Yu. Sokolov,
    K. Patkowski, A. E. DePrince III, U. Bozkaya, R. A. King,
    F. A. Evangelista, J. M. Turney, T. D. Crawford, C. D. Sherrill,
    J. Chem. Phys. 152(18) 184108 (2020). https://doi.org/10.1063/5.0006002

                            Additional Code Authors
    E. T. Seidl, C. L. Janssen, E. F. Valeev, M. L. Leininger,
    J. F. Gonthier, R. M. Richard, H. R. McAlexander, M. Saitow, X. Wang,
    P. Verma, and M. H. Lechner

             Previous Authors, Complete List of Code Contributors,
                       and Citations for Specific Modules
    https://github.com/psi4/psi4/blob/master/codemeta.json
    https://github.com/psi4/psi4/graphs/contributors
    http://psicode.org/psi4manual/master/introduction.html#citing-psifour

    -----------------------------------------------------------------------


    Psi4 started on: Wednesday, 16 June 2021 11:35AM

    Process ID: 8838
    Host:       Shuhe.Wang
    PSIDATADIR: /Users/shuhe.wang/src/psi4_debug_obj/stage/share/psi4
    Memory:     500.0 MiB
    Threads:    1
    
  ==> Input File <==

--------------------------------------------------------------------------
#! Generated using commit GITCOMMIT

import forte

ref_grad = psi4.Matrix.from_list([
      [-0.521586919763,    -1.188829187079,    -0.914234910278],
      [-0.877544461704,    -1.015038289914,     0.232457682530],
      [ 1.052395793208,     2.131164236150,     0.332015275804],
      [ 0.346735588259,     0.072703240844,     0.349761951944]
      ])

molecule {
0 1
H  1.0     0.8      0.6
H  0.9     0.5      0.4
H  0.76    0.23     0.35
H  0.34    0.45     -0.11
}

set {
  basis cc-pvdz
  reference rhf
  scf_type pk
  e_convergence 10
  d_convergence 8
  active          [4]
   mcscf_type           conv
   mcscf_maxiter        200
   mcscf_diis_start     20
   MCSCF_E_CONVERGENCE  10
   MCSCF_R_CONVERGENCE  8
   g_convergence     gau_verytight
}

set scf_type direct

set forte {
  REF_TYPE  CASSCF
  CASSCF_G_CONVERGENCE   1e-10
  CASSCF_E_CONVERGENCE   1e-10
  active          [4]
  active_space_solver  cas
  correlation_solver   dsrg-mrpt2
  dsrg_s               1.0
   dsrgpt               true
   print_denom2         true
   multiplicity         1 
}


grad = gradient('forte')

compare_matrices(ref_grad, grad, 6, "DSRG-MRPT2 gradient on 4 H atoms with c1 symmetry")





--------------------------------------------------------------------------

Scratch directory: /tmp/
gradient() will perform analytic gradient computation.

  Forte
  ----------------------------------------------------------------------------
  A suite of quantum chemistry methods for strongly correlated electrons

    git branch: gradient_x - git commit: 06462197

  Developed by:
    Francesco A. Evangelista, Chenyang Li, Kevin P. Hannon,
    Jeffrey B. Schriber, Tianyuan Zhang, Chenxi Cai,
    Nan He, Nicholas Stair, Shuhe Wang, Renke Huang
  ----------------------------------------------------------------------------

  Size of Determinant class: 128 bits

  Preparing forte objects from a Psi4 Wavefunction object
  No reference wave function provided for Forte. Computing CASSCF orbitals using Psi4 ...

*** tstart() called on Shuhe.Wang
*** at Wed Jun 16 11:35:16 2021

   => Loading Basis Set <=

    Name: CC-PVDZ
    Role: ORBITAL
    Keyword: BASIS
    atoms 1-4 entry H          line    22 file /Users/shuhe.wang/src/psi4_debug_obj/stage/share/psi4/basis/cc-pvdz.gbs 


         ---------------------------------------------------------
                                   SCF
               by Justin Turney, Rob Parrish, Andy Simmonett
                          and Daniel G. A. Smith
                              RHF Reference
                        1 Threads,    500 MiB Core
         ---------------------------------------------------------

  ==> Geometry <==

    Molecular point group: c1
    Full point group: C1

    Geometry (in Angstrom), charge = 0, multiplicity = 1:

       Center              X                  Y                   Z               Mass       
    ------------   -----------------  -----------------  -----------------  -----------------
         H            0.250000000000     0.305000000000     0.290000000000     1.007825032230
         H            0.150000000000     0.005000000000     0.090000000000     1.007825032230
         H            0.010000000000    -0.265000000000     0.040000000000     1.007825032230
         H           -0.410000000000    -0.045000000000    -0.420000000000     1.007825032230

  Running in c1 symmetry.

  Rotational constants: A =    135.83283  B =     29.42198  C =     24.39203 [cm^-1]
  Rotational constants: A = 4072165.93732  B = 882048.68364  C = 731254.80679 [MHz]
  Nuclear repulsion =    5.936062724947204

  Charge       = 0
  Multiplicity = 1
  Electrons    = 4
  Nalpha       = 2
  Nbeta        = 2

  ==> Algorithm <==

  SCF Algorithm Type is DIRECT.
  DIIS enabled.
  MOM disabled.
  Fractional occupation disabled.
  Guess Type is SAD.
  Energy threshold   = 1.00e-10
  Density threshold  = 1.00e-08
  Integral threshold = 1.00e-12

  ==> Primary Basis <==

  Basis Set: CC-PVDZ
    Blend: CC-PVDZ
    Number of shells: 12
    Number of basis functions: 20
    Number of Cartesian functions: 20
    Spherical Harmonics?: true
    Max angular momentum: 1

   => Loading Basis Set <=

    Name: (CC-PVDZ AUX)
    Role: JKFIT
    Keyword: DF_BASIS_SCF
    atoms 1-4 entry H          line    51 file /Users/shuhe.wang/src/psi4_debug_obj/stage/share/psi4/basis/cc-pvdz-jkfit.gbs 

  Starting with a DF guess...

  ==> Integral Setup <==

  DFHelper Memory: AOs need 0.000 GiB; user supplied 0.366 GiB. Using in-core AOs.

  ==> MemDFJK: Density-Fitted J/K Matrices <==

    J tasked:                   Yes
    K tasked:                   Yes
    wK tasked:                   No
    OpenMP threads:               1
    Memory [MiB]:               375
    Algorithm:                 Core
    Schwarz Cutoff:           1E-12
    Mask sparsity (%):       0.0000
    Fitting Condition:        1E-10

   => Auxiliary Basis Set <=

  Basis Set: (CC-PVDZ AUX)
    Blend: CC-PVDZ-JKFIT
    Number of shells: 36
    Number of basis functions: 92
    Number of Cartesian functions: 100
    Spherical Harmonics?: true
    Max angular momentum: 2

  Minimum eigenvalue in the overlap matrix is 1.5734799588E-03.
  Reciprocal condition number of the overlap matrix is 2.5887482839E-04.
    Using symmetric orthogonalization.

  ==> Pre-Iterations <==

  SCF Guess: Superposition of Atomic Densities via on-the-fly atomic UHF (no occupation information).

   -------------------------
    Irrep   Nso     Nmo    
   -------------------------
     A         20      20 
   -------------------------
    Total      20      20
   -------------------------

  ==> Iterations <==

                           Total Energy        Delta E     RMS |[F,P]|

   @DF-RHF iter SAD:    -1.28981482059562   -1.28981e+00   0.00000e+00 
   @DF-RHF iter   1:    -0.87018303996845    4.19632e-01   1.05620e-02 DIIS
   @DF-RHF iter   2:    -0.90431359152286   -3.41306e-02   2.40401e-03 DIIS
   @DF-RHF iter   3:    -0.90677568337167   -2.46209e-03   4.10012e-04 DIIS
   @DF-RHF iter   4:    -0.90688362084459   -1.07937e-04   1.12397e-04 DIIS
   @DF-RHF iter   5:    -0.90689808114012   -1.44603e-05   4.02119e-05 DIIS
   @DF-RHF iter   6:    -0.90690025388269   -2.17274e-06   5.98329e-06 DIIS
   @DF-RHF iter   7:    -0.90690029517295   -4.12903e-08   2.30728e-06 DIIS
   @DF-RHF iter   8:    -0.90690030376521   -8.59227e-09   1.91008e-07 DIIS
   @DF-RHF iter   9:    -0.90690030381432   -4.91052e-11   2.44192e-08 DIIS
   @DF-RHF iter  10:    -0.90690030381485   -5.30465e-13   3.25107e-09 DIIS

  DF guess converged.

  ==> DirectJK: Integral-Direct J/K Matrices <==

    J tasked:                  Yes
    K tasked:                  Yes
    wK tasked:                  No
    Integrals threads:           1
    Schwarz Cutoff:          1E-12

   @RHF iter  11:    -0.90685310688178   -9.06853e-01   1.19281e-05 DIIS
   @RHF iter  12:    -0.90685315426941   -4.73876e-08   2.43003e-06 DIIS
   @RHF iter  13:    -0.90685315698600   -2.71660e-09   6.09429e-07 DIIS
   @RHF iter  14:    -0.90685315726343   -2.77428e-10   1.60311e-07 DIIS
   @RHF iter  15:    -0.90685315729302   -2.95866e-11   4.62315e-08 DIIS
   @RHF iter  16:    -0.90685315729562   -2.60458e-12   8.26263e-09 DIIS
  Energy and wave function converged.


  ==> Post-Iterations <==

    Orbital Energies [Eh]
    ---------------------

    Doubly Occupied:                                                      

       1A     -1.389556     2A     -0.302891  

    Virtual:                                                              

       3A      0.153895     4A      0.200725     5A      0.321012  
       6A      0.544797     7A      0.866440     8A      1.100540  
       9A      1.352973    10A      1.619874    11A      1.706077  
      12A      1.950347    13A      2.069380    14A      2.388812  
      15A      2.532243    16A      2.672511    17A      3.122524  
      18A      3.688671    19A      6.289757    20A      8.198355  

    Final Occupation by Irrep:
              A 
    DOCC [     2 ]

  @RHF Final Energy:    -0.90685315729562

   => Energetics <=

    Nuclear Repulsion Energy =              5.9360627249472042
    One-Electron Energy =                 -10.3009380252007485
    Two-Electron Energy =                   3.4580221429579212
    Total Energy =                         -0.9068531572956231

Computation Completed


Properties will be evaluated at   0.000000,   0.000000,   0.000000 [a0]

Properties computed using the SCF density matrix

  Nuclear Dipole Moment: [e a0]
     X:     0.0000      Y:     0.0000      Z:     0.0000

  Electronic Dipole Moment: [e a0]
     X:     0.4975      Y:     0.1044      Z:     0.4965

  Dipole Moment: [e a0]
     X:     0.4975      Y:     0.1044      Z:     0.4965     Total:     0.7106

  Dipole Moment: [D]
     X:     1.2646      Y:     0.2654      Z:     1.2621     Total:     1.8062


*** tstop() called on Shuhe.Wang at Wed Jun 16 11:35:16 2021
Module time:
	user time   =       0.26 seconds =       0.00 minutes
	system time =       0.01 seconds =       0.00 minutes
	total time  =          0 seconds =       0.00 minutes
Total time:
	user time   =       0.26 seconds =       0.00 minutes
	system time =       0.01 seconds =       0.00 minutes
	total time  =          0 seconds =       0.00 minutes
 MINTS: Wrapper to libmints.
   by Justin Turney

   Calculation information:
      Number of threads:                 1
      Number of atoms:                   4
      Number of AO shells:              12
      Number of SO shells:              12
      Number of primitives:             20
      Number of atomic orbitals:        20
      Number of basis functions:        20

      Number of irreps:                  1
      Integral cutoff                 1.00e-12
      Number of functions per irrep: [  20 ]

 OEINTS: Overlap, kinetic, potential, dipole, and quadrupole integrals
         stored in file 35.

      Computing two-electron integrals...done
      Computed 21807 non-zero two-electron integrals.
        Stored in file 33.

 MINTS: Wrapper to libmints.
   by Justin Turney

   Calculation information:
      Number of threads:                 1
      Number of atoms:                   4
      Number of AO shells:              12
      Number of SO shells:              12
      Number of primitives:             20
      Number of atomic orbitals:        20
      Number of basis functions:        20

      Number of irreps:                  1
      Integral cutoff                 1.00e-12
      Number of functions per irrep: [  20 ]

 OEINTS: Overlap, kinetic, potential, dipole, and quadrupole integrals
         stored in file 35.

      Computing two-electron integrals...done
      Computed 21807 non-zero two-electron integrals.
        Stored in file 33.


         ---------------------------------------------------------
                Multi-Configurational Self-Consistent Field
                            (a 'D E T C I' module)

                 Daniel G. A. Smith, C. David Sherrill, and
                              Matt L. Leininger
         ---------------------------------------------------------


   ==> Parameters <==

    EX LEVEL       =        4      H0 BLOCKSIZE  =     1000
    VAL EX LEVEL   =        0      H0 GUESS SIZE =     1000
    H0COUPLINGSIZE =        0      H0 COUPLING   =       NO
    MAXITER        =       12      NUM PRINT     =       20
    NUM ROOTS      =        1      ICORE         =        1
    PRINT LVL      =        1      FCI           =      YES
    R CONV         = 1.00e-07      MIXED         =      YES
    E CONV         = 1.00e-10      MIXED4        =      YES
    R4S            =       NO      REPL OTF      =       NO
    DIAG METHOD    =      SEM      FOLLOW ROOT   =        0
    PRECONDITIONER = DAVIDSON      UPDATE        = DAVIDSON
    S              =   0.0000      Ms0           =      YES
    GUESS VECTOR   =  H0BLOCK      OPENTYPE      =     NONE
    COLLAPSE SIZE  =        1      HD AVG        = EVANGELISTI
    MAX NUM VECS   =       13      REF SYM       =     AUTO
    IOPEN        =       NO

    EX ALLOW       =  1  1  1  1 
    STATE AVERAGE  =  0(1.00) 

   ==> CI Orbital and Space information <==

   ------------------------------------
               Space    Total     A
   ------------------------------------
                 Nso       20    20
                 Nmo       20    20
               Ndocc        2     2
               Nsocc        0     0
   ------------------------------------
               MCSCF Spaces
   ------------------------------------
         Frozen DOCC        0     0
     Restricted DOCC        0     0
              Active        4     4
     Restricted UOCC       16    16
         Frozen UOCC        0     0
   ------------------------------------

   ==> Setting up CI strings <==

    There are 6 alpha and 6 beta strings
    The CI space requires 36 (3.60E+01) determinants and 1 blocks

   ==> Setting up MCSCF integrals <==

  ==> DirectJK: Integral-Direct J/K Matrices <==

    J tasked:                  Yes
    K tasked:                  Yes
    wK tasked:                  No
    Integrals threads:           1
    Schwarz Cutoff:          1E-12


   ==> Starting MCSCF iterations <==

        Iter         Total Energy       Delta E   Orb RMS    CI RMS  NCI NORB
   @MCSCF  1:     -0.911360715053   -4.5076e-03  2.96e-03  8.93e-14    1    1  Initial CI
   @MCSCF  2:     -0.924738812538   -1.3378e-02  5.11e-03  1.19e-06    6    1  TS
   @MCSCF  3:     -0.928126799503   -3.3880e-03  2.57e-03  2.27e-06    6    1  TS
   @MCSCF  4:     -0.929380035982   -1.2532e-03  1.47e-03  5.73e-07    7    1  TS
   @MCSCF  5:     -0.930056319791   -6.7628e-04  9.88e-04  6.20e-07    7    1  TS
   @MCSCF  6:     -0.930620523994   -5.6420e-04  8.55e-04  3.37e-07    7    1  TS
   @MCSCF  7:     -0.931216307509   -5.9578e-04  8.97e-04  1.50e-07    8    1  TS
   @MCSCF  8:     -0.931866485730   -6.5018e-04  9.80e-04  3.33e-07    7    1  TS
   @MCSCF  9:     -0.932539522281   -6.7304e-04  1.05e-03  5.24e-07    7    1  TS
   @MCSCF 10:     -0.933191019250   -6.5150e-04  1.09e-03  5.23e-07    7    1  TS
   @MCSCF 11:     -0.933788324381   -5.9731e-04  1.12e-03  4.47e-07    7    1  TS
   @MCSCF 12:     -0.934314766442   -5.2644e-04  1.13e-03  3.53e-07    7    1  TS
   @MCSCF 13:     -0.934762820352   -4.4805e-04  1.10e-03  2.45e-07    7    1  TS
   @MCSCF 14:     -0.935128427365   -3.6561e-04  1.03e-03  9.09e-07    6    1  TS
   @MCSCF 15:     -0.935411311143   -2.8288e-04  9.19e-04  5.94e-07    6    1  TS
   @MCSCF 16:     -0.935617832800   -2.0652e-04  7.79e-04  3.77e-07    6    1  TS
   @MCSCF 17:     -0.935760916488   -1.4308e-04  6.36e-04  2.35e-07    6    1  TS
   @MCSCF 18:     -0.935856300520   -9.5384e-05  5.08e-04  5.59e-07    5    1  TS
   @MCSCF 19:     -0.935918449300   -6.2149e-05  4.00e-04  4.54e-07    5    1  TS
   @MCSCF 20:     -0.935958534801   -4.0086e-05  3.14e-04  5.97e-08    6    1  TS
   @MCSCF 21:     -0.935984339169   -2.5804e-05  2.46e-04  3.93e-08    6    1  TS, DIIS
   @MCSCF 22:     -0.936000990015   -1.6651e-05  1.94e-04  2.57e-08    6    1  TS, DIIS
   @MCSCF 23:     -0.935786407756    2.1458e-04  9.19e-04  1.03e-07    7    1  TS, DIIS
   @MCSCF 24:     -0.935858699184   -7.2291e-05  7.96e-04  7.46e-07    5    1  TS, DIIS
   @MCSCF 25:     -0.935887005032   -2.8306e-05  6.72e-04  2.38e-07    5    1  TS, DIIS
   @MCSCF 26:     -0.935595217705    2.9179e-04  1.29e-03  4.18e-07    6    1  TS, DIIS
   @MCSCF 27:     -0.935514778672    8.0439e-05  1.44e-03  7.26e-07    5    1  TS, DIIS
   @MCSCF 28:     -0.936023102933   -5.0832e-04  1.81e-04  5.32e-07    6    1  TS, DIIS
   @MCSCF 29:     -0.936032355961   -9.2530e-06  1.97e-05  5.19e-08    6    1  TS, DIIS
   @MCSCF 30:     -0.936032390565   -3.4604e-08  8.58e-06  3.05e-09    6    1  TS, DIIS
   @MCSCF 31:     -0.936032410923   -2.0358e-08  5.99e-06  1.37e-09    6    1  TS, DIIS
   @MCSCF 32:     -0.936032418200   -7.2765e-09  1.91e-06  1.51e-09    6    1  TS, DIIS
   @MCSCF 33:     -0.936032419063   -8.6280e-10  1.44e-06  2.76e-10    6    1  TS, DIIS
   @MCSCF 34:     -0.936032420136   -1.0732e-09  5.44e-07  8.88e-10    6    1  TS, DIIS
   @MCSCF 35:     -0.936032420261   -1.2573e-10  3.30e-07  4.29e-10    6    1  TS, DIIS
   @MCSCF 36:     -0.936032420282   -2.0813e-11  2.10e-07  1.14e-10    6    1  TS, DIIS
   @MCSCF 37:     -0.936032420289   -6.6187e-12  1.02e-07  5.73e-11    6    1  TS, DIIS
   @MCSCF 38:     -0.936032420290   -1.0090e-12  2.60e-08  1.69e-11    6    1  TS, DIIS
   @MCSCF 39:     -0.936032420290   -1.6165e-13  1.89e-08  7.12e-12    6    1  TS, DIIS
   @MCSCF 40:     -0.936032420290   -1.1191e-13  7.44e-09  1.47e-12    7    1  TS, DIIS

          @MCSCF has converged!

   @MCSCF Final Energy:   -0.936032420290136

   Computing CI Semicanonical Orbitals

   ==> Energetics <==

    SCF energy =           -0.906853157295623
    Total MCSCF energy =   -0.936032420290136

   ==> MCSCF root 0 information <==

    MCSCF Root 0 energy =    -0.936032420290140

   Active Space Natural occupation numbers:

         A   1.995232         A   1.971362         A   0.019456
         A   0.013950

   The 20 most important determinants:

    *   1   -0.991612  (    0,    0)  1AX 2AX 
    *   2    0.083647  (    3,    3)  1AX 4AX 
    *   3    0.077619  (    1,    1)  1AX 3AX 
    *   4   -0.025949  (    0,    5)  1AA 2AA 3AB 4AB 
    *   5   -0.025949  (    5,    0)  1AB 2AB 3AA 4AA 
    *   6    0.023720  (    2,    2)  2AX 3AX 
    *   7    0.022315  (    4,    4)  2AX 4AX 
    *   8    0.021235  (    2,    3)  1AB 2AA 3AA 4AB 
    *   9    0.021235  (    3,    2)  1AA 2AB 3AB 4AA 
    *  10    0.007759  (    2,    4)  2AX 3AA 4AB 
    *  11    0.007759  (    4,    2)  2AX 3AB 4AA 
    *  12    0.006257  (    1,    3)  1AX 3AA 4AB 
    *  13    0.006257  (    3,    1)  1AX 3AB 4AA 
    *  14   -0.005527  (    3,    4)  1AA 2AB 4AX 
    *  15   -0.005527  (    4,    3)  1AB 2AA 4AX 
    *  16   -0.005353  (    5,    5)  3AX 4AX 
    *  17   -0.004715  (    1,    4)  1AA 2AB 3AA 4AB 
    *  18   -0.004715  (    4,    1)  1AB 2AA 3AB 4AA 
    *  19    0.003716  (    0,    3)  1AX 2AA 4AB 
    *  20    0.003716  (    3,    0)  1AX 2AB 4AA 



Properties will be evaluated at   0.000000,   0.000000,   0.000000 [a0]

Properties computed using the CASSCF density matrix

  Nuclear Dipole Moment: [e a0]
     X:     0.0000      Y:     0.0000      Z:     0.0000

  Electronic Dipole Moment: [e a0]
     X:     0.4650      Y:     0.0730      Z:     0.4641

  Dipole Moment: [e a0]
     X:     0.4650      Y:     0.0730      Z:     0.4641     Total:     0.6610

  Dipole Moment: [D]
     X:     1.1820      Y:     0.1855      Z:     1.1795     Total:     1.6801


  Read options for space ACTIVE

  ==> MO Space Information <==

  -------------------------------
                        A   Sum
  -------------------------------
    FROZEN_DOCC         0     0
    RESTRICTED_DOCC     0     0
    GAS1                4     4
    GAS2                0     0
    GAS3                0     0
    GAS4                0     0
    GAS5                0     0
    GAS6                0     0
    RESTRICTED_UOCC    16    16
    FROZEN_UOCC         0     0
    Total              20    20
  -------------------------------   => Loading Basis Set <=

    Name: STO-3G
    Role: ORBITAL
    Keyword: MINAO_BASIS
    atoms 1-4 entry H          line    19 file /Users/shuhe.wang/src/psi4_debug_obj/stage/share/psi4/basis/sto-3g.gbs 



  ==> Primary Basis Set Summary <==

  Basis Set: CC-PVDZ
    Blend: CC-PVDZ
    Number of shells: 12
    Number of basis functions: 20
    Number of Cartesian functions: 20
    Spherical Harmonics?: true
    Max angular momentum: 1


  JK created using conventional PK integrals
  Using in-core PK algorithm.
   Calculation information:
      Number of atoms:                   4
      Number of AO shells:              12
      Number of primitives:             20
      Number of atomic orbitals:        20
      Number of basis functions:        20

      Integral cutoff                 1.00e-12
      Number of threads:                 1

  Performing in-core PK
  Using 44310 doubles for integral storage.
  We computed 3081 shell quartets total.
  Whereas there are 3081 unique shell quartets.

  ==> DiskJK: Disk-Based J/K Matrices <==

    J tasked:                  Yes
    K tasked:                  Yes
    wK tasked:                  No
    Memory [MiB]:              400
    Schwarz Cutoff:          1E-12

    OpenMP threads:              1



  ==> Integral Transformation <==

  Number of molecular orbitals:                         20
  Number of correlated molecular orbitals:              20
  Number of frozen occupied orbitals:                    0
  Number of frozen unoccupied orbitals:                  0
  Two-electron integral type:                 Conventional


  Computing Conventional Integrals	Presorting SO-basis two-electron integrals.
	Sorting File: SO Ints (nn|nn) nbuckets = 1
	Constructing frozen core operators
	Starting first half-transformation.
	Sorting half-transformed integrals.
	First half integral transformation complete.
	Starting second half-transformation.
	Two-electron integral transformation complete.

  Integral transformation done. 0.01537069 s
  Reading the two-electron integrals from disk
  Size of two-electron integrals:   0.003576 GB
  Timing for conventional integral transformation:            0.031 s.
  Timing for freezing core and virtual orbitals:              0.000 s.
  Timing for computing conventional integrals:                0.032 s.

  ==> Summary of Active Space Solver Input <==

    Irrep.  Multi.(2ms)      N
    --------------------------
        A      1  (  0)      1
    --------------------------
    N: number of roots
    ms: spin z component
    Total number of roots:   1
    --------------------------


              ---------------------------------------------------
                Complete Active Space Configuration Interaction
                                  Chenyang Li
              ---------------------------------------------------


  ==> Input Summary <==

    No. a electrons in active      =     2
    No. b electrons in active      =     2
    multiplicity                   =     1
    spin ms (2 * Sz)               =     0

  ==> Orbital Spaces <==

    TOTAL MO                      [   20 ]
    FROZEN CORE                   [    0 ]
    FROZEN VIRTUAL                [    0 ]
    CORRELATED MO                 [   20 ]
    CORE                          [    0 ]
    ACTIVE                        [    4 ]
    VIRTUAL                       [   16 ]
  Forming alpha and beta strings      ...  Done. Timing        0.000023 s
  Forming determinants                ...  Done. Timing        0.000020 s

  ==> Determinants Summary <==

    number of alpha active electrons         =     2
    number of beta active electrons          =     2
    root symmetry (zero based)               =     0
    number of determinants                   =    36

  Diagonalizing Hamiltonian           ...

  ==> Computing 1 Coupling Lists <==

        α          3.311e-05 seconds
        β          2.840e-05 seconds

  ==> Computing 2 Coupling Lists <==

        αα         1.757e-05 seconds
        ββ         1.453e-05 seconds
        αβ         3.540e-05 seconds

  Davidson-Liu solver algorithm using SigmaVectorSparseList sigma algorithm

  Performing diagonalization of the H matrix
  Found 20 roots with 2S+1 = 1 *
  Found 15 roots with 2S+1 = 3
  Found 1 roots with 2S+1 = 5  Done. Timing        0.000649 s

  * * * * * * * * * * * * * * * * *
  *  CI Vectors & Configurations  *
  * * * * * * * * * * * * * * * * *

  ==> Root No. 0 <==

    2200          0.9916123787
    2002         -0.0836473649
    2020         -0.0776191297

    Total Energy:   -0.936032420290154



  ==> Permanent Dipole Moments (A) <==

  Only print nonzero (> 1.0e-5) elements.
  Permanent dipole moments (a.u.) 0 -> 0:  X:  0.4650  Y:  0.0730  Z:  0.4641  Total:  0.6610


  ==> Energy Summary <==

    Multi.(2ms)  Irrep.  No.               Energy      <S^2>
    --------------------------------------------------------
       1  (  0)     A     0       -0.936032420290       n/a
    --------------------------------------------------------

  ==> Computing 1 Coupling Lists <==

        α          2.880e-05 seconds
        β          2.782e-05 seconds

  ==> Computing 1 Coupling Lists <==

        α          2.651e-05 seconds
        β          6.329e-05 seconds

  ==> Computing 2 Coupling Lists <==

        αα         2.479e-05 seconds
        ββ         2.295e-05 seconds
        αβ         5.551e-05 seconds

  ==> Computing 2 Coupling Lists <==

        αα         1.884e-05 seconds
        ββ         1.776e-05 seconds
        αβ         4.270e-05 seconds

  ==> Computing 2 Coupling Lists <==

        αα         1.620e-05 seconds
        ββ         1.524e-05 seconds
        αβ         3.684e-05 seconds

  ==> Computing 3 Coupling Lists <==

        ααα        9.984e-06 seconds
        ααβ        3.873e-05 seconds
        αββ        2.349e-05 seconds
        βββ        8.324e-06 seconds

  ==> Computing 3 Coupling Lists <==

        ααα        9.416e-06 seconds
        ααβ        3.461e-05 seconds
        αββ        2.135e-05 seconds
        βββ        8.282e-06 seconds

  ==> Computing 3 Coupling Lists <==

        ααα        9.561e-06 seconds
        ααβ        3.320e-05 seconds
        αββ        2.093e-05 seconds
        βββ        8.741e-06 seconds

  ==> Computing 3 Coupling Lists <==

        ααα        9.110e-06 seconds
        ααβ        3.263e-05 seconds
        αββ        2.079e-05 seconds
        βββ        7.855e-06 seconds
 Computing  1RDMs (0 Singlet A - 0 Singlet A) ... Done. Timing        0.000094 s
 Computing  2RDMs (0 Singlet A - 0 Singlet A) ... Done. Timing        0.000097 s
 Computing  3RDMs (0 Singlet A - 0 Singlet A) ... Done. Timing        0.000176 s

       -----------------------------------------------------------------
                            Semi-Canonical Orbitals
         Chenyang Li, Jeffrey B. Schriber and Francesco A. Evangelista
       -----------------------------------------------------------------

  Took 0.000444 s to build Fock matrix

  ==> Checking Fock Matrix Diagonal Blocks <==

    Off-Diag. Elements       Max           2-Norm
    ------------------------------------------------
    FROZEN_DOCC          0.0000000000   0.0000000000
    FROZEN_UOCC          0.0000000000   0.0000000000
    GAS1                 0.0000000000   0.0000000000
    GAS2                 0.0000000000   0.0000000000
    GAS3                 0.0000000000   0.0000000000
    GAS4                 0.0000000000   0.0000000000
    GAS5                 0.0000000000   0.0000000000
    GAS6                 0.0000000000   0.0000000000
    RESTRICTED_DOCC      0.0000000000   0.0000000000
    RESTRICTED_UOCC      0.0000000000   0.0000000000
    ------------------------------------------------
  Orbitals are already semicanonicalized.

  ==> Multireference Driven Similarity Renormalization Group <==

    Computing Fock matrix and cleaning JK ........... Done
    Reading DSRG options ............................ Done
    Setting ambit MO space .......................... Done
    Preparing tensors for density cumulants ......... Done
    Filling Fock matrix from ForteIntegrals ......... Done

              ----------------------------------------------------
                    MR-DSRG Second-Order Perturbation Theory
                Chenyang Li, Kevin Hannon, Francesco Evangelista
              ----------------------------------------------------

    References:
      u-DSRG-MRPT2:    J. Chem. Theory Comput. 2015, 11, 2097.
      (pr-)DSRG-MRPT2: J. Chem. Phys. 2017, 146, 124132.

  ==> Calculation Information <==

    int_type                                    CONVENTIONAL
    source operator                                 STANDARD
    reference relaxation                                NONE
    state_type                                STATE-SPECIFIC
    form Hbar3                                         FALSE
    flow parameter                                 1.000e+00
    taylor expansion threshold                     1.000e-03
    intruder_tamp                                  1.000e-01
    ntamp                                                 15


  ==> Checking Semicanonical Orbitals <==

    Block             Fa Max         Fa Mean           Fb Max         Fb Mean
    -------------------------------------------------------------------------
    CORE        0.0000000000    0.0000000000     0.0000000000    0.0000000000
    VIRTUAL     0.0000000000    0.0000000000     0.0000000000    0.0000000000
    GAS1        0.0000000000    0.0000000000     0.0000000000    0.0000000000
    -------------------------------------------------------------------------
    Orbitals are semi-canonicalized.

  ==> Computing DSRG-MRPT2 ... <==

    Computing T2 amplitudes                  ...  Done. Timing        0.012158 s
    Computing T1 amplitudes                  ...  Done. Timing        0.002708 s
    Renormalizing two-electron integrals     ...  Done. Timing        0.002960 s
    Renormalizing Fock matrix elements       ...  Done. Timing        0.002804 s
    Computing <[F, T1]>                      ...  Done. Timing        0.001215 s
    Computing <[F, T2]>                      ...  Done. Timing        0.003606 s
    Computing <[V, T1]>                      ...  Done. Timing        0.004062 s
    Computing <[V, T2]> (C_2)^4              ...  Done. Timing        0.022819 s
    Computing <[V, T2]> C_4 (C_2)^2 HH       ...  Done. Timing        0.005437 s
    Computing <[V, T2]> C_4 (C_2)^2 PP       ...  Done. Timing        0.005852 s
    Computing <[V, T2]> C_4 (C_2)^2 PH       ...  Done. Timing        0.028283 s
    Computing <[V, T2]> C_6 C_2              ...  Done. Timing        0.027022 s

  ==> Excitation Amplitudes Summary <==

    Active Indices: 
    Largest T1 amplitudes for spin case A:
       i       a                  i       a                  i       a               
    --------------------------------------------------------------------------------
    [  2      13    ]-0.159839 [  3      17    ] 0.098206 [  3       8    ]-0.096652 
    [  2      11    ]-0.089770 [  2       9    ]-0.086849 [  2      15    ] 0.081502 
    [  2       8    ]-0.074666 [  3      13    ] 0.071323 [  3       9    ] 0.067635 
    [  3      16    ]-0.060699 [  3       6    ] 0.053546 [  2      17    ]-0.036515 
    [  3       7    ]-0.035913 [  2      14    ] 0.031580 [  3      18    ] 0.024156 
    --------------------------------------------------------------------------------
    Norm of T1A vector: (nonzero elements: 64)                    0.309066843540409.
    --------------------------------------------------------------------------------
    Largest T1 amplitudes for spin case B:
       _       _                  _       _                  _       _               
       i       a                  i       a                  i       a               
    --------------------------------------------------------------------------------
    [  2      13    ]-0.159839 [  3      17    ] 0.098206 [  3       8    ]-0.096652 
    [  2      11    ]-0.089770 [  2       9    ]-0.086849 [  2      15    ] 0.081502 
    [  2       8    ]-0.074666 [  3      13    ] 0.071323 [  3       9    ] 0.067635 
    [  3      16    ]-0.060699 [  3       6    ] 0.053546 [  2      17    ]-0.036515 
    [  3       7    ]-0.035913 [  2      14    ] 0.031580 [  3      18    ] 0.024156 
    --------------------------------------------------------------------------------
    Norm of T1B vector: (nonzero elements: 64)                    0.309066843540409.
    --------------------------------------------------------------------------------
    Largest T2 amplitudes for spin case AA:
       i   j   a   b              i   j   a   b              i   j   a   b           
    --------------------------------------------------------------------------------
    [  2   3   3  13] 0.042639 [  0   2   0  13]-0.039449 [  0   3   0  13] 0.034465 
    [  0   2   0  15] 0.031105 [  2   3   6  13] 0.027958 [  1   2   1  13]-0.027185 
    [  2   3   3   9] 0.024222 [  0   3   0   9] 0.023599 [  1   3   3   6]-0.023549 
    [  2   3   6   9] 0.023167 [  0   3   0  17] 0.021080 [  2   3   3  11] 0.020541 
    [  0   2   0  11]-0.018793 [  1   2   1  11]-0.018043 [  0   3   1  13]-0.016210 
    --------------------------------------------------------------------------------
    Norm of T2AA vector: (nonzero elements: 4416)                 0.306801505111456.
    --------------------------------------------------------------------------------
    Largest T2 amplitudes for spin case AB:
           _       _                  _       _                  _       _           
       i   j   a   b              i   j   a   b              i   j   a   b           
    --------------------------------------------------------------------------------
    [  0   2   0  13]-0.050731 [  0   2   0  15] 0.045579 [  0   3   0  13] 0.044028 
    [  0   3   0   9] 0.037476 [  1   2   1  13]-0.034299 [  3   3   1   6] 0.032432 
    [  2   2   2  13]-0.031811 [  3   3   9   9]-0.031669 [  1   3   3   6]-0.031083 
    [  0   3   0  17] 0.029280 [  2   2   1   6]-0.028431 [  1   2   2   6] 0.027374 
    [  0   0   0   4]-0.027343 [  2   3   1  13]-0.027314 [  0   0   0   5] 0.027299 
    --------------------------------------------------------------------------------
    Norm of T2AB vector: (nonzero elements: 6144)                 0.377807018861015.
    --------------------------------------------------------------------------------
    Largest T2 amplitudes for spin case BB:
       _   _   _   _              _   _   _   _              _   _   _   _           
       i   j   a   b              i   j   a   b              i   j   a   b           
    --------------------------------------------------------------------------------
    [  2   3   3  13] 0.042639 [  0   2   0  13]-0.039449 [  0   3   0  13] 0.034465 
    [  0   2   0  15] 0.031105 [  2   3   6  13] 0.027958 [  1   2   1  13]-0.027185 
    [  2   3   3   9] 0.024222 [  0   3   0   9] 0.023599 [  1   3   3   6]-0.023549 
    [  2   3   6   9] 0.023167 [  0   3   0  17] 0.021080 [  2   3   3  11] 0.020541 
    [  0   2   0  11]-0.018793 [  1   2   1  11]-0.018043 [  0   3   1  13]-0.016210 
    --------------------------------------------------------------------------------
    Norm of T2BB vector: (nonzero elements: 4416)                 0.306801505111456.
    --------------------------------------------------------------------------------

  ==> Possible Intruders <==

    T1 amplitudes larger than 0.1000 for spin case A:
        Amplitude         Value                  Denominator              
    ----------------------------------------------------------------------
    [  2      13    ]   -0.15983864 (  0.648154 -   2.332654 =  -1.684500)
    ----------------------------------------------------------------------
    T1 amplitudes larger than 0.1000 for spin case B:
        Amplitude         Value                  Denominator              
    ----------------------------------------------------------------------
    [  2      13    ]   -0.15983864 (  0.648154 -   2.332654 =  -1.684500)
    ----------------------------------------------------------------------
    T2 amplitudes larger than 0.1000 for spin case AA: NULL
    T2 amplitudes larger than 0.1000 for spin case AB: NULL
    T2 amplitudes larger than 0.1000 for spin case BB: NULL

  ==> DSRG-MRPT2 Energy Summary <==

    E0 (reference)                 =     -0.936032420290147
    <[F, T1]>                      =     -0.003216228283693
    <[F, T2]>                      =      0.005335352172396
    <[V, T1]>                      =      0.002686042007220
    <[V, T2]> (C_2)^4              =     -0.039885074053746
    <[V, T2]> C_4 (C_2)^2 HH       =      0.000000000000000
    <[V, T2]> C_4 (C_2)^2 PP       =      0.004399120310250
    <[V, T2]> C_4 (C_2)^2 PH       =     -0.003041194281849
    <[V, T2]> C_6 C_2              =     -0.000407717449565
    <[V, T2]>                      =     -0.038934865474910
    DSRG-MRPT2 correlation energy  =     -0.034129699578988
    DSRG-MRPT2 total energy        =     -0.970162119869134
    max(T1)                        =      0.159838636017874
    max(T2)                        =      0.050731417728166
    ||T1||                         =      0.437086521814690
    ||T2||                         =      0.871324796548278

  Energy took      0.124 s


                            -----------------------
                              DSRG-MRPT2 Gradient
                                  Shuhe Wang
                            -----------------------

    Initializing Global Variables ................... Done
    Initializing RDMs, DSRG Tensors and CI integrals. Done
    Initializing Sigma .............................. Done
    Initializing Xi ................................. Done
    Initializing Tau ................................ Done
    Initializing Kappa .............................. Done
    Initializing Diagonal Entries of Z .............. Done
    Initializing b of the Linear System ............. Done
    Initializing A of the Linear System ............. Done
    Solving Off-diagonal Entries of Z ............... Done
    Solving Entries of W ............................ Done
    Writing Lagrangian .............................. Done
    Writing 1RDM Coefficients ....................... Done
    Writing 2RDM Coefficients ....................... Done

  ==> Back-transforming MO-basis TPDMs <==

    Presorting MO-basis TPDM.
    Sorting File: MO TPDM (AA|AA) nbuckets = 1
    Sorting File: MO TPDM (AA|aa) nbuckets = 1
    Sorting File: MO TPDM (aa|aa) nbuckets = 1
    Starting first half-transformation.
    Sorting half-transformed TPDMs.
    First half integral transformation complete.
    Starting second half-transformation.
    Second half integral transformation complete.

    TPDM Backtransformation ......................... Done
    Computing Gradient .............................. Done


  ==> Total Timings (s) for Computing Commutators <==

             [H1, T1]    [H1, T2]    [H2, T1]    [H2, T2]
    -----------------------------------------------------
    -> C0       0.001       0.004       0.004       0.090
    -> C1       0.000       0.000       0.000       0.000
    -> C2                   0.000       0.000       0.000
    -----------------------------------------------------
    Molecular point group: c1
    Full point group: C1

    Geometry (in Bohr), charge = 0, multiplicity = 1:

       Center              X                  Y                   Z       
    ------------   -----------------  -----------------  -----------------
         H            0.472431531364     0.576366468265     0.548020576383
         H            0.283458918819     0.009448630627     0.170075351291
         H            0.018897261255    -0.500777423246     0.075589045018
         H           -0.774787711438    -0.085037675646    -0.793684972692



  -Total gradient:
     Atom            X                  Y                   Z
    ------   -----------------  -----------------  -----------------
       1       -0.521586919763    -1.188829187079    -0.914234910278
       2       -0.877544461704    -1.015038289914     0.232457682530
       3        1.052395793208     2.131164236150     0.332015275804
       4        0.346735588259     0.072703240844     0.349761951944



 ==> Forte Timings <==

  Time to prepare integrals            :        0.040 seconds
  Time to run forte energy             :        4.368 seconds
  Time to compute derivative integrals :        0.023 seconds
  Total                                :        4.431 seconds
    DSRG-MRPT2 gradient on 4 H atoms with c1 symmetry.....................................PASSED

    Psi4 stopped on: Wednesday, 16 June 2021 11:35AM
    Psi4 wall time for execution: 0:00:05.83

*** Psi4 exiting successfully. Buy a developer a beer!
